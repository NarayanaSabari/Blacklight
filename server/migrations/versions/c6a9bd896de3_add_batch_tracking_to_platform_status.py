"""add_batch_tracking_to_platform-status

Revision ID: c6a9bd896de3
Revises: 3fadedf1cedc
Create Date: 2026-01-12 11:30:35.534617

"""
from typing import Sequence, Union

from alembic import op
import sqlalchemy as sa
from sqlalchemy.dialects import postgresql

# revision identifiers, used by Alembic.
revision: str = 'c6a9bd896de3'
down_revision: Union[str, Sequence[str], None] = '3fadedf1cedc'
branch_labels: Union[str, Sequence[str], None] = None
depends_on: Union[str, Sequence[str], None] = None


def upgrade() -> None:
    """Upgrade schema."""
    # ### commands auto generated by Alembic - please adjust! ###
    # NOTE: The following drop operations are for NocoDB tables that existed in the
    # original database but may not exist in a fresh database. We skip them entirely
    # since they are not part of Blacklight's schema.
    from sqlalchemy import inspect
    from sqlalchemy.exc import ProgrammingError
    
    conn = op.get_bind()
    inspector = inspect(conn)
    existing_tables = set(inspector.get_table_names())
    
    def safe_drop_index(index_name, table_name):
        """Only drop index if the table exists."""
        if table_name in existing_tables:
            try:
                op.drop_index(index_name, table_name=table_name)
            except (ProgrammingError, Exception):
                pass  # Index doesn't exist or already dropped
    
    def safe_drop_table(table_name):
        """Only drop table if it exists."""
        if table_name in existing_tables:
            try:
                op.drop_table(table_name)
            except (ProgrammingError, Exception):
                pass  # Table doesn't exist
    
    # =========================================================================
    # NocoDB cleanup - these tables existed in the original database but are
    # not part of Blacklight. Skip if they don't exist (fresh database).
    # =========================================================================
    nocodb_tables = [
        'nc_sort_v2', 'nc_hooks_v2', 'nc_kanban_view_v2', 'nc_widgets_v2',
        'nc_shared_views_v2', 'nc_base_users_v2', 'nc_col_select_options_v2',
        'nc_col_relations_v2', 'nc_store', 'nc_audit_v2', 'xc_knex_migrationsv2',
        'nc_map_view_v2', 'nc_integrations_v2', 'nc_calendar_view_columns_v2',
        'nc_hook_logs_v2', 'nc_sync_logs_v2', 'nc_user_comment_notifications_preference',
        'nc_integrations_store_v2', 'nc_team_users_v2', 'notification',
        'nc_row_color_conditions', 'nc_data_reflection', 'xc_knex_migrations',
        'nc_file_references', 'nc_plugins_v2', 'nc_jobs', 'nc_form_view_v2',
        'nc_gallery_view_columns_v2', 'nc_col_rollup_v2', 'nc_user_refresh_tokens',
        'nc_sync_mappings', 'nc_col_qrcode_v2', 'nc_col_barcode_v2', 'nc_teams_v2',
        'nc_comments', 'nc_comment_reactions', 'nc_col_button_v2', 'nc_users_v2',
        'nc_grid_view_v2', 'nc_col_formula_v2', 'nc_mcp_tokens', 'nc_views_v2',
        'nc_filter_exp_v2', 'nc_kanban_view_columns_v2', 'nc_form_view_columns_v2',
        'nc_col_lookup_v2', 'xc_knex_migrations_lock', 'nc_orgs_v2', 'nc_columns_v2',
        'nc_extensions', 'nc_shared_bases', 'nc_gallery_view_v2', 'nc_sync_configs',
        'nc_calendar_view_v2', 'nc_map_view_columns_v2', 'nc_sync_source_v2',
        'nc_calendar_view_range_v2', 'nc_col_long_text_v2', 'nc_grid_view_columns_v2',
        'nc_audit_v2_old', 'nc_bases_v2', 'nc_hook_trigger_fields',
        'nc_disabled_models_for_role_v2', 'nc_sources_v2', 'nc_models_v2',
        'xc_knex_migrationsv2_lock', 'nc_api_tokens', 'nc_permissions',
        'nc_dashboards_v2', 'nc_permission_subjects'
    ]
    
    # Drop all NocoDB tables (if they exist)
    for table in nocodb_tables:
        safe_drop_table(table)
    
    # =========================================================================
    # Actual Blacklight schema changes
    # =========================================================================
    
    # Helper to safely drop/recreate indexes (they may not exist on fresh DB)
    def safe_recreate_index(index_name, table_name, columns, postgresql_ops=None):
        """Safely drop and recreate an index."""
        try:
            op.drop_index(index_name, table_name=table_name)
        except (ProgrammingError, Exception):
            pass  # Index doesn't exist
        op.create_index(index_name, table_name, columns, unique=False, postgresql_ops=postgresql_ops)
    
    # Recreate indexes with proper ordering
    safe_recreate_index('idx_candidate_job_match_candidate_score', 'candidate_job_matches', 
                        ['candidate_id', 'match_score'], postgresql_ops={'match_score': 'DESC'})
    safe_recreate_index('idx_candidate_job_match_score_desc', 'candidate_job_matches', 
                        ['match_score'], postgresql_ops={'match_score': 'DESC'})
    safe_recreate_index('idx_job_application_applied_at_desc', 'job_applications', 
                        ['applied_at'], postgresql_ops={'applied_at': 'DESC'})
    safe_recreate_index('idx_job_import_batch_started_at_desc', 'job_import_batches', 
                        ['started_at'], postgresql_ops={'started_at': 'DESC'})
    safe_recreate_index('idx_job_posting_posted_date_desc', 'job_postings', 
                        ['posted_date'], postgresql_ops={'posted_date': 'DESC'})
    
    # Add new columns to session_platform_status
    op.add_column('session_platform_status', sa.Column('total_batches', sa.Integer(), nullable=True))
    op.add_column('session_platform_status', sa.Column('completed_batches', sa.Integer(), nullable=True))
    
    # More index recreation
    safe_recreate_index('idx_submission_activity_submission_created', 'submission_activities', 
                        ['submission_id', 'created_at'], postgresql_ops={'created_at': 'DESC'})
    safe_recreate_index('idx_submission_submitted_at', 'submissions', 
                        ['submitted_at'], postgresql_ops={'submitted_at': 'DESC'})
    # ### end Alembic commands ###


def downgrade() -> None:
    """Downgrade schema."""
    # ### commands auto generated by Alembic - please adjust! ###
    op.drop_index('idx_submission_submitted_at', table_name='submissions', postgresql_ops={'submitted_at': 'DESC'})
    op.create_index(op.f('idx_submission_submitted_at'), 'submissions', [sa.literal_column('submitted_at DESC')], unique=False)
    op.drop_index('idx_submission_activity_submission_created', table_name='submission_activities', postgresql_ops={'created_at': 'DESC'})
    op.create_index(op.f('idx_submission_activity_submission_created'), 'submission_activities', ['submission_id', sa.literal_column('created_at DESC')], unique=False)
    op.drop_column('session_platform_status', 'completed_batches')
    op.drop_column('session_platform_status', 'total_batches')
    op.drop_index('idx_job_posting_posted_date_desc', table_name='job_postings', postgresql_ops={'posted_date': 'DESC'})
    op.create_index(op.f('idx_job_posting_posted_date_desc'), 'job_postings', [sa.literal_column('posted_date DESC')], unique=False)
    op.drop_index('idx_job_import_batch_started_at_desc', table_name='job_import_batches', postgresql_ops={'started_at': 'DESC'})
    op.create_index(op.f('idx_job_import_batch_started_at_desc'), 'job_import_batches', [sa.literal_column('started_at DESC')], unique=False)
    op.drop_index('idx_job_application_applied_at_desc', table_name='job_applications', postgresql_ops={'applied_at': 'DESC'})
    op.create_index(op.f('idx_job_application_applied_at_desc'), 'job_applications', [sa.literal_column('applied_at DESC')], unique=False)
    op.drop_index('idx_candidate_job_match_score_desc', table_name='candidate_job_matches', postgresql_ops={'match_score': 'DESC'})
    op.create_index(op.f('idx_candidate_job_match_score_desc'), 'candidate_job_matches', [sa.literal_column('match_score DESC')], unique=False)
    op.drop_index('idx_candidate_job_match_candidate_score', table_name='candidate_job_matches', postgresql_ops={'match_score': 'DESC'})
    op.create_index(op.f('idx_candidate_job_match_candidate_score'), 'candidate_job_matches', ['candidate_id', sa.literal_column('match_score DESC')], unique=False)
    op.create_table('nc_permission_subjects',
    sa.Column('fk_permission_id', sa.VARCHAR(length=20), autoincrement=False, nullable=False),
    sa.Column('subject_type', sa.VARCHAR(length=255), autoincrement=False, nullable=False),
    sa.Column('subject_id', sa.VARCHAR(length=255), autoincrement=False, nullable=False),
    sa.Column('fk_workspace_id', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('base_id', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('created_at', postgresql.TIMESTAMP(timezone=True), server_default=sa.text('CURRENT_TIMESTAMP'), autoincrement=False, nullable=False),
    sa.Column('updated_at', postgresql.TIMESTAMP(timezone=True), server_default=sa.text('CURRENT_TIMESTAMP'), autoincrement=False, nullable=False),
    sa.PrimaryKeyConstraint('fk_permission_id', 'subject_type', 'subject_id', name=op.f('nc_permission_subjects_pkey'))
    )
    op.create_index(op.f('nc_permission_subjects_context'), 'nc_permission_subjects', ['fk_workspace_id', 'base_id'], unique=False)
    op.create_table('nc_dashboards_v2',
    sa.Column('id', sa.VARCHAR(length=20), autoincrement=False, nullable=False),
    sa.Column('fk_workspace_id', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('base_id', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('title', sa.VARCHAR(length=255), autoincrement=False, nullable=False),
    sa.Column('description', sa.TEXT(), autoincrement=False, nullable=True),
    sa.Column('meta', sa.TEXT(), autoincrement=False, nullable=True),
    sa.Column('order', sa.INTEGER(), autoincrement=False, nullable=True),
    sa.Column('created_by', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('owned_by', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('created_at', postgresql.TIMESTAMP(timezone=True), server_default=sa.text('CURRENT_TIMESTAMP'), autoincrement=False, nullable=False),
    sa.Column('updated_at', postgresql.TIMESTAMP(timezone=True), server_default=sa.text('CURRENT_TIMESTAMP'), autoincrement=False, nullable=False),
    sa.Column('uuid', sa.VARCHAR(length=255), autoincrement=False, nullable=True),
    sa.Column('password', sa.VARCHAR(length=255), autoincrement=False, nullable=True),
    sa.Column('fk_custom_url_id', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.PrimaryKeyConstraint('id', name=op.f('nc_dashboards_v2_pkey'))
    )
    op.create_index(op.f('share_uuid_idx'), 'nc_dashboards_v2', ['uuid'], unique=False)
    op.create_index(op.f('nc_dashboards_context'), 'nc_dashboards_v2', ['base_id', 'fk_workspace_id'], unique=False)
    op.create_table('nc_permissions',
    sa.Column('id', sa.VARCHAR(length=20), autoincrement=False, nullable=False),
    sa.Column('fk_workspace_id', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('base_id', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('entity', sa.VARCHAR(length=255), autoincrement=False, nullable=True),
    sa.Column('entity_id', sa.VARCHAR(length=255), autoincrement=False, nullable=True),
    sa.Column('permission', sa.VARCHAR(length=255), autoincrement=False, nullable=True),
    sa.Column('created_by', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('enforce_for_form', sa.BOOLEAN(), server_default=sa.text('true'), autoincrement=False, nullable=True),
    sa.Column('enforce_for_automation', sa.BOOLEAN(), server_default=sa.text('true'), autoincrement=False, nullable=True),
    sa.Column('granted_type', sa.VARCHAR(length=255), autoincrement=False, nullable=True),
    sa.Column('granted_role', sa.VARCHAR(length=255), autoincrement=False, nullable=True),
    sa.Column('created_at', postgresql.TIMESTAMP(timezone=True), server_default=sa.text('CURRENT_TIMESTAMP'), autoincrement=False, nullable=False),
    sa.Column('updated_at', postgresql.TIMESTAMP(timezone=True), server_default=sa.text('CURRENT_TIMESTAMP'), autoincrement=False, nullable=False),
    sa.PrimaryKeyConstraint('id', name=op.f('nc_permissions_pkey'))
    )
    op.create_index(op.f('nc_permissions_entity'), 'nc_permissions', ['entity', 'entity_id', 'permission'], unique=False)
    op.create_index(op.f('nc_permissions_context'), 'nc_permissions', ['base_id', 'fk_workspace_id'], unique=False)
    op.create_table('nc_api_tokens',
    sa.Column('id', sa.INTEGER(), autoincrement=True, nullable=False),
    sa.Column('base_id', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('db_alias', sa.VARCHAR(length=255), autoincrement=False, nullable=True),
    sa.Column('description', sa.VARCHAR(length=255), autoincrement=False, nullable=True),
    sa.Column('permissions', sa.TEXT(), autoincrement=False, nullable=True),
    sa.Column('token', sa.TEXT(), autoincrement=False, nullable=True),
    sa.Column('expiry', sa.VARCHAR(length=255), autoincrement=False, nullable=True),
    sa.Column('enabled', sa.BOOLEAN(), server_default=sa.text('true'), autoincrement=False, nullable=True),
    sa.Column('created_at', postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=True),
    sa.Column('updated_at', postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=True),
    sa.Column('fk_user_id', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('fk_sso_client_id', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.PrimaryKeyConstraint('id', name=op.f('nc_api_tokens_pkey'))
    )
    op.create_index(op.f('nc_api_tokens_fk_user_id_index'), 'nc_api_tokens', ['fk_user_id'], unique=False)
    op.create_index(op.f('nc_api_tokens_fk_sso_client_id_index'), 'nc_api_tokens', ['fk_sso_client_id'], unique=False)
    op.create_table('xc_knex_migrationsv2_lock',
    sa.Column('index', sa.INTEGER(), autoincrement=True, nullable=False),
    sa.Column('is_locked', sa.INTEGER(), autoincrement=False, nullable=True),
    sa.PrimaryKeyConstraint('index', name=op.f('xc_knex_migrationsv2_lock_pkey'))
    )
    op.create_table('nc_models_v2',
    sa.Column('id', sa.VARCHAR(length=20), autoincrement=False, nullable=False),
    sa.Column('source_id', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('base_id', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('table_name', sa.VARCHAR(length=255), autoincrement=False, nullable=True),
    sa.Column('title', sa.VARCHAR(length=255), autoincrement=False, nullable=True),
    sa.Column('type', sa.VARCHAR(length=255), server_default=sa.text("'table'::character varying"), autoincrement=False, nullable=True),
    sa.Column('meta', sa.TEXT(), autoincrement=False, nullable=True),
    sa.Column('schema', sa.TEXT(), autoincrement=False, nullable=True),
    sa.Column('enabled', sa.BOOLEAN(), server_default=sa.text('true'), autoincrement=False, nullable=True),
    sa.Column('mm', sa.BOOLEAN(), server_default=sa.text('false'), autoincrement=False, nullable=True),
    sa.Column('tags', sa.VARCHAR(length=255), autoincrement=False, nullable=True),
    sa.Column('pinned', sa.BOOLEAN(), autoincrement=False, nullable=True),
    sa.Column('deleted', sa.BOOLEAN(), autoincrement=False, nullable=True),
    sa.Column('order', sa.REAL(), autoincrement=False, nullable=True),
    sa.Column('created_at', postgresql.TIMESTAMP(timezone=True), server_default=sa.text('CURRENT_TIMESTAMP'), autoincrement=False, nullable=False),
    sa.Column('updated_at', postgresql.TIMESTAMP(timezone=True), server_default=sa.text('CURRENT_TIMESTAMP'), autoincrement=False, nullable=False),
    sa.Column('description', sa.TEXT(), autoincrement=False, nullable=True),
    sa.Column('synced', sa.BOOLEAN(), server_default=sa.text('false'), autoincrement=False, nullable=True),
    sa.Column('created_by', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('owned_by', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('uuid', sa.VARCHAR(length=255), autoincrement=False, nullable=True),
    sa.Column('password', sa.VARCHAR(length=255), autoincrement=False, nullable=True),
    sa.Column('fk_custom_url_id', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.PrimaryKeyConstraint('id', name=op.f('nc_models_v2_pkey'))
    )
    op.create_index(op.f('nc_models_v2_uuid_index'), 'nc_models_v2', ['uuid'], unique=False)
    op.create_index(op.f('nc_models_v2_type_index'), 'nc_models_v2', ['type'], unique=False)
    op.create_index(op.f('nc_models_v2_source_id_index'), 'nc_models_v2', ['source_id'], unique=False)
    op.create_index(op.f('nc_models_v2_base_id_index'), 'nc_models_v2', ['base_id'], unique=False)
    op.create_table('nc_sources_v2',
    sa.Column('id', sa.VARCHAR(length=20), autoincrement=False, nullable=False),
    sa.Column('base_id', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('alias', sa.VARCHAR(length=255), autoincrement=False, nullable=True),
    sa.Column('config', sa.TEXT(), autoincrement=False, nullable=True),
    sa.Column('meta', sa.TEXT(), autoincrement=False, nullable=True),
    sa.Column('is_meta', sa.BOOLEAN(), autoincrement=False, nullable=True),
    sa.Column('type', sa.VARCHAR(length=255), autoincrement=False, nullable=True),
    sa.Column('inflection_column', sa.VARCHAR(length=255), autoincrement=False, nullable=True),
    sa.Column('inflection_table', sa.VARCHAR(length=255), autoincrement=False, nullable=True),
    sa.Column('created_at', postgresql.TIMESTAMP(timezone=True), server_default=sa.text('CURRENT_TIMESTAMP'), autoincrement=False, nullable=False),
    sa.Column('updated_at', postgresql.TIMESTAMP(timezone=True), server_default=sa.text('CURRENT_TIMESTAMP'), autoincrement=False, nullable=False),
    sa.Column('enabled', sa.BOOLEAN(), server_default=sa.text('true'), autoincrement=False, nullable=True),
    sa.Column('order', sa.REAL(), autoincrement=False, nullable=True),
    sa.Column('description', sa.VARCHAR(length=255), autoincrement=False, nullable=True),
    sa.Column('erd_uuid', sa.VARCHAR(length=255), autoincrement=False, nullable=True),
    sa.Column('deleted', sa.BOOLEAN(), server_default=sa.text('false'), autoincrement=False, nullable=True),
    sa.Column('is_schema_readonly', sa.BOOLEAN(), server_default=sa.text('false'), autoincrement=False, nullable=True),
    sa.Column('is_data_readonly', sa.BOOLEAN(), server_default=sa.text('false'), autoincrement=False, nullable=True),
    sa.Column('fk_integration_id', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('is_local', sa.BOOLEAN(), server_default=sa.text('false'), autoincrement=False, nullable=True),
    sa.Column('is_encrypted', sa.BOOLEAN(), server_default=sa.text('false'), autoincrement=False, nullable=True),
    sa.PrimaryKeyConstraint('id', name=op.f('nc_bases_v2_pkey'))
    )
    op.create_index(op.f('nc_sources_v2_fk_integration_id_index'), 'nc_sources_v2', ['fk_integration_id'], unique=False)
    op.create_index(op.f('nc_sources_v2_base_id_index'), 'nc_sources_v2', ['base_id'], unique=False)
    op.create_table('nc_disabled_models_for_role_v2',
    sa.Column('id', sa.VARCHAR(length=20), autoincrement=False, nullable=False),
    sa.Column('source_id', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('base_id', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('fk_view_id', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('role', sa.VARCHAR(length=45), autoincrement=False, nullable=True),
    sa.Column('disabled', sa.BOOLEAN(), server_default=sa.text('true'), autoincrement=False, nullable=True),
    sa.Column('created_at', postgresql.TIMESTAMP(timezone=True), server_default=sa.text('CURRENT_TIMESTAMP'), autoincrement=False, nullable=False),
    sa.Column('updated_at', postgresql.TIMESTAMP(timezone=True), server_default=sa.text('CURRENT_TIMESTAMP'), autoincrement=False, nullable=False),
    sa.PrimaryKeyConstraint('id', name=op.f('nc_disabled_models_for_role_v2_pkey'))
    )
    op.create_index(op.f('nc_disabled_models_for_role_v2_fk_view_id_index'), 'nc_disabled_models_for_role_v2', ['fk_view_id'], unique=False)
    op.create_index(op.f('nc_disabled_models_for_role_v2_base_id_index'), 'nc_disabled_models_for_role_v2', ['base_id'], unique=False)
    op.create_table('nc_hook_trigger_fields',
    sa.Column('fk_hook_id', sa.VARCHAR(length=20), autoincrement=False, nullable=False),
    sa.Column('fk_column_id', sa.VARCHAR(length=20), autoincrement=False, nullable=False),
    sa.Column('base_id', sa.VARCHAR(length=20), autoincrement=False, nullable=False),
    sa.Column('fk_workspace_id', sa.VARCHAR(length=20), autoincrement=False, nullable=False),
    sa.Column('created_at', postgresql.TIMESTAMP(timezone=True), server_default=sa.text('CURRENT_TIMESTAMP'), autoincrement=False, nullable=False),
    sa.Column('updated_at', postgresql.TIMESTAMP(timezone=True), server_default=sa.text('CURRENT_TIMESTAMP'), autoincrement=False, nullable=False),
    sa.PrimaryKeyConstraint('fk_workspace_id', 'base_id', 'fk_hook_id', 'fk_column_id', name=op.f('nc_hook_trigger_fields_pkey'))
    )
    op.create_table('nc_bases_v2',
    sa.Column('id', sa.VARCHAR(length=128), autoincrement=False, nullable=False),
    sa.Column('title', sa.VARCHAR(length=255), autoincrement=False, nullable=True),
    sa.Column('prefix', sa.VARCHAR(length=255), autoincrement=False, nullable=True),
    sa.Column('status', sa.VARCHAR(length=255), autoincrement=False, nullable=True),
    sa.Column('description', sa.TEXT(), autoincrement=False, nullable=True),
    sa.Column('meta', sa.TEXT(), autoincrement=False, nullable=True),
    sa.Column('color', sa.VARCHAR(length=255), autoincrement=False, nullable=True),
    sa.Column('uuid', sa.VARCHAR(length=255), autoincrement=False, nullable=True),
    sa.Column('password', sa.VARCHAR(length=255), autoincrement=False, nullable=True),
    sa.Column('roles', sa.VARCHAR(length=255), autoincrement=False, nullable=True),
    sa.Column('deleted', sa.BOOLEAN(), server_default=sa.text('false'), autoincrement=False, nullable=True),
    sa.Column('is_meta', sa.BOOLEAN(), autoincrement=False, nullable=True),
    sa.Column('order', sa.REAL(), autoincrement=False, nullable=True),
    sa.Column('created_at', postgresql.TIMESTAMP(timezone=True), server_default=sa.text('CURRENT_TIMESTAMP'), autoincrement=False, nullable=False),
    sa.Column('updated_at', postgresql.TIMESTAMP(timezone=True), server_default=sa.text('CURRENT_TIMESTAMP'), autoincrement=False, nullable=False),
    sa.Column('default_role', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.PrimaryKeyConstraint('id', name=op.f('nc_projects_v2_pkey'))
    )
    op.create_table('nc_audit_v2_old',
    sa.Column('id', sa.VARCHAR(length=20), autoincrement=False, nullable=False),
    sa.Column('user', sa.VARCHAR(length=255), autoincrement=False, nullable=True),
    sa.Column('ip', sa.VARCHAR(length=255), autoincrement=False, nullable=True),
    sa.Column('source_id', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('base_id', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('fk_model_id', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('row_id', sa.VARCHAR(length=255), autoincrement=False, nullable=True),
    sa.Column('op_type', sa.VARCHAR(length=255), autoincrement=False, nullable=True),
    sa.Column('op_sub_type', sa.VARCHAR(length=255), autoincrement=False, nullable=True),
    sa.Column('status', sa.VARCHAR(length=255), autoincrement=False, nullable=True),
    sa.Column('description', sa.TEXT(), autoincrement=False, nullable=True),
    sa.Column('details', sa.TEXT(), autoincrement=False, nullable=True),
    sa.Column('created_at', postgresql.TIMESTAMP(timezone=True), server_default=sa.text('CURRENT_TIMESTAMP'), autoincrement=False, nullable=False),
    sa.Column('updated_at', postgresql.TIMESTAMP(timezone=True), server_default=sa.text('CURRENT_TIMESTAMP'), autoincrement=False, nullable=False),
    sa.Column('version', sa.SMALLINT(), server_default=sa.text("'0'::smallint"), autoincrement=False, nullable=True),
    sa.Column('fk_user_id', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('fk_ref_id', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('fk_parent_id', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('user_agent', sa.TEXT(), autoincrement=False, nullable=True),
    sa.PrimaryKeyConstraint('id', name=op.f('nc_audit_v2_pkey'))
    )
    op.create_index(op.f('nc_audit_v2_row_id_index'), 'nc_audit_v2_old', ['row_id'], unique=False)
    op.create_index(op.f('nc_audit_v2_fk_model_id_index'), 'nc_audit_v2_old', ['fk_model_id'], unique=False)
    op.create_index(op.f('nc_audit_v2_base_id_index'), 'nc_audit_v2_old', ['base_id'], unique=False)
    op.create_table('nc_grid_view_columns_v2',
    sa.Column('id', sa.VARCHAR(length=20), autoincrement=False, nullable=False),
    sa.Column('fk_view_id', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('fk_column_id', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('source_id', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('base_id', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('uuid', sa.VARCHAR(length=255), autoincrement=False, nullable=True),
    sa.Column('label', sa.VARCHAR(length=255), autoincrement=False, nullable=True),
    sa.Column('help', sa.VARCHAR(length=255), autoincrement=False, nullable=True),
    sa.Column('width', sa.VARCHAR(length=255), server_default=sa.text("'200px'::character varying"), autoincrement=False, nullable=True),
    sa.Column('show', sa.BOOLEAN(), autoincrement=False, nullable=True),
    sa.Column('order', sa.REAL(), autoincrement=False, nullable=True),
    sa.Column('created_at', postgresql.TIMESTAMP(timezone=True), server_default=sa.text('CURRENT_TIMESTAMP'), autoincrement=False, nullable=False),
    sa.Column('updated_at', postgresql.TIMESTAMP(timezone=True), server_default=sa.text('CURRENT_TIMESTAMP'), autoincrement=False, nullable=False),
    sa.Column('group_by', sa.BOOLEAN(), autoincrement=False, nullable=True),
    sa.Column('group_by_order', sa.REAL(), autoincrement=False, nullable=True),
    sa.Column('group_by_sort', sa.VARCHAR(length=255), autoincrement=False, nullable=True),
    sa.Column('aggregation', sa.VARCHAR(length=30), server_default=sa.text('NULL::character varying'), autoincrement=False, nullable=True),
    sa.PrimaryKeyConstraint('id', name=op.f('nc_grid_view_columns_v2_pkey'))
    )
    op.create_index(op.f('nc_grid_view_columns_v2_fk_view_id_index'), 'nc_grid_view_columns_v2', ['fk_view_id'], unique=False)
    op.create_index(op.f('nc_grid_view_columns_v2_fk_view_id_fk_column_id_index'), 'nc_grid_view_columns_v2', ['fk_view_id', 'fk_column_id'], unique=False)
    op.create_index(op.f('nc_grid_view_columns_v2_fk_column_id_index'), 'nc_grid_view_columns_v2', ['fk_column_id'], unique=False)
    op.create_index(op.f('nc_grid_view_columns_v2_base_id_index'), 'nc_grid_view_columns_v2', ['base_id'], unique=False)
    op.create_table('nc_col_long_text_v2',
    sa.Column('id', sa.VARCHAR(length=20), autoincrement=False, nullable=False),
    sa.Column('fk_workspace_id', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('base_id', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('fk_model_id', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('fk_column_id', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('fk_integration_id', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('model', sa.VARCHAR(length=255), autoincrement=False, nullable=True),
    sa.Column('prompt', sa.TEXT(), autoincrement=False, nullable=True),
    sa.Column('prompt_raw', sa.TEXT(), autoincrement=False, nullable=True),
    sa.Column('error', sa.TEXT(), autoincrement=False, nullable=True),
    sa.Column('created_at', postgresql.TIMESTAMP(timezone=True), server_default=sa.text('CURRENT_TIMESTAMP'), autoincrement=False, nullable=False),
    sa.Column('updated_at', postgresql.TIMESTAMP(timezone=True), server_default=sa.text('CURRENT_TIMESTAMP'), autoincrement=False, nullable=False),
    sa.PrimaryKeyConstraint('id', name=op.f('nc_col_long_text_v2_pkey'))
    )
    op.create_index(op.f('nc_col_long_text_v2_fk_column_id_index'), 'nc_col_long_text_v2', ['fk_column_id'], unique=False)
    op.create_index(op.f('nc_col_long_text_context'), 'nc_col_long_text_v2', ['base_id', 'fk_workspace_id'], unique=False)
    op.create_table('nc_calendar_view_range_v2',
    sa.Column('id', sa.VARCHAR(length=20), autoincrement=False, nullable=False),
    sa.Column('fk_view_id', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('fk_to_column_id', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('label', sa.VARCHAR(length=40), autoincrement=False, nullable=True),
    sa.Column('fk_from_column_id', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('created_at', postgresql.TIMESTAMP(timezone=True), server_default=sa.text('CURRENT_TIMESTAMP'), autoincrement=False, nullable=False),
    sa.Column('updated_at', postgresql.TIMESTAMP(timezone=True), server_default=sa.text('CURRENT_TIMESTAMP'), autoincrement=False, nullable=False),
    sa.Column('base_id', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.PrimaryKeyConstraint('id', name=op.f('nc_calendar_view_range_v2_pkey'))
    )
    op.create_index(op.f('nc_calendar_view_range_v2_base_id_index'), 'nc_calendar_view_range_v2', ['base_id'], unique=False)
    op.create_table('nc_sync_source_v2',
    sa.Column('id', sa.VARCHAR(length=20), autoincrement=False, nullable=False),
    sa.Column('title', sa.VARCHAR(length=255), autoincrement=False, nullable=True),
    sa.Column('type', sa.VARCHAR(length=255), autoincrement=False, nullable=True),
    sa.Column('details', sa.TEXT(), autoincrement=False, nullable=True),
    sa.Column('deleted', sa.BOOLEAN(), autoincrement=False, nullable=True),
    sa.Column('enabled', sa.BOOLEAN(), server_default=sa.text('true'), autoincrement=False, nullable=True),
    sa.Column('order', sa.REAL(), autoincrement=False, nullable=True),
    sa.Column('base_id', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('fk_user_id', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('created_at', postgresql.TIMESTAMP(timezone=True), server_default=sa.text('CURRENT_TIMESTAMP'), autoincrement=False, nullable=False),
    sa.Column('updated_at', postgresql.TIMESTAMP(timezone=True), server_default=sa.text('CURRENT_TIMESTAMP'), autoincrement=False, nullable=False),
    sa.Column('source_id', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.PrimaryKeyConstraint('id', name=op.f('nc_sync_source_v2_pkey'))
    )
    op.create_index(op.f('nc_sync_source_v2_source_id_index'), 'nc_sync_source_v2', ['source_id'], unique=False)
    op.create_index(op.f('nc_sync_source_v2_base_id_index'), 'nc_sync_source_v2', ['base_id'], unique=False)
    op.create_table('nc_map_view_columns_v2',
    sa.Column('id', sa.VARCHAR(length=20), autoincrement=False, nullable=False),
    sa.Column('base_id', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('project_id', sa.VARCHAR(length=128), autoincrement=False, nullable=True),
    sa.Column('fk_view_id', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('fk_column_id', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('uuid', sa.VARCHAR(length=255), autoincrement=False, nullable=True),
    sa.Column('label', sa.VARCHAR(length=255), autoincrement=False, nullable=True),
    sa.Column('help', sa.VARCHAR(length=255), autoincrement=False, nullable=True),
    sa.Column('show', sa.BOOLEAN(), autoincrement=False, nullable=True),
    sa.Column('order', sa.REAL(), autoincrement=False, nullable=True),
    sa.Column('created_at', postgresql.TIMESTAMP(timezone=True), server_default=sa.text('CURRENT_TIMESTAMP'), autoincrement=False, nullable=False),
    sa.Column('updated_at', postgresql.TIMESTAMP(timezone=True), server_default=sa.text('CURRENT_TIMESTAMP'), autoincrement=False, nullable=False),
    sa.PrimaryKeyConstraint('id', name=op.f('nc_map_view_columns_v2_pkey'))
    )
    op.create_index(op.f('nc_map_view_columns_v2_fk_view_id_index'), 'nc_map_view_columns_v2', ['fk_view_id'], unique=False)
    op.create_index(op.f('nc_map_view_columns_v2_fk_view_id_fk_column_id_index'), 'nc_map_view_columns_v2', ['fk_view_id', 'fk_column_id'], unique=False)
    op.create_index(op.f('nc_map_view_columns_v2_fk_column_id_index'), 'nc_map_view_columns_v2', ['fk_column_id'], unique=False)
    op.create_index(op.f('nc_map_view_columns_v2_base_id_index'), 'nc_map_view_columns_v2', ['base_id'], unique=False)
    op.create_table('nc_calendar_view_v2',
    sa.Column('fk_view_id', sa.VARCHAR(length=20), autoincrement=False, nullable=False),
    sa.Column('base_id', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('source_id', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('title', sa.VARCHAR(length=255), autoincrement=False, nullable=True),
    sa.Column('fk_cover_image_col_id', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('meta', sa.TEXT(), autoincrement=False, nullable=True),
    sa.Column('created_at', postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=True),
    sa.Column('updated_at', postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=True),
    sa.PrimaryKeyConstraint('fk_view_id', name=op.f('nc_calendar_view_v2_pkey'))
    )
    op.create_index(op.f('nc_calendar_view_v2_base_id_index'), 'nc_calendar_view_v2', ['base_id'], unique=False)
    op.create_table('nc_sync_configs',
    sa.Column('id', sa.VARCHAR(length=20), autoincrement=False, nullable=False),
    sa.Column('fk_workspace_id', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('base_id', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('fk_integration_id', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('fk_model_id', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('sync_type', sa.VARCHAR(length=255), autoincrement=False, nullable=True),
    sa.Column('sync_trigger', sa.VARCHAR(length=255), autoincrement=False, nullable=True),
    sa.Column('sync_trigger_cron', sa.VARCHAR(length=255), autoincrement=False, nullable=True),
    sa.Column('sync_trigger_secret', sa.VARCHAR(length=255), autoincrement=False, nullable=True),
    sa.Column('sync_job_id', sa.VARCHAR(length=255), autoincrement=False, nullable=True),
    sa.Column('last_sync_at', postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=True),
    sa.Column('next_sync_at', postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=True),
    sa.Column('created_at', postgresql.TIMESTAMP(timezone=True), server_default=sa.text('CURRENT_TIMESTAMP'), autoincrement=False, nullable=False),
    sa.Column('updated_at', postgresql.TIMESTAMP(timezone=True), server_default=sa.text('CURRENT_TIMESTAMP'), autoincrement=False, nullable=False),
    sa.Column('title', sa.VARCHAR(length=255), autoincrement=False, nullable=True),
    sa.Column('sync_category', sa.VARCHAR(length=255), autoincrement=False, nullable=True),
    sa.Column('fk_parent_sync_config_id', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('on_delete_action', sa.VARCHAR(length=255), server_default=sa.text("'mark_deleted'::character varying"), autoincrement=False, nullable=True),
    sa.PrimaryKeyConstraint('id', name=op.f('nc_sync_configs_pkey'))
    )
    op.create_index(op.f('sync_configs_integration_model'), 'nc_sync_configs', ['fk_model_id', 'fk_integration_id'], unique=False)
    op.create_index(op.f('nc_sync_configs_parent_idx'), 'nc_sync_configs', ['fk_parent_sync_config_id'], unique=False)
    op.create_index(op.f('nc_sync_configs_context'), 'nc_sync_configs', ['base_id', 'fk_workspace_id'], unique=False)
    op.create_table('nc_gallery_view_v2',
    sa.Column('source_id', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('base_id', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('fk_view_id', sa.VARCHAR(length=20), autoincrement=False, nullable=False),
    sa.Column('next_enabled', sa.BOOLEAN(), autoincrement=False, nullable=True),
    sa.Column('prev_enabled', sa.BOOLEAN(), autoincrement=False, nullable=True),
    sa.Column('cover_image_idx', sa.INTEGER(), autoincrement=False, nullable=True),
    sa.Column('fk_cover_image_col_id', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('cover_image', sa.VARCHAR(length=255), autoincrement=False, nullable=True),
    sa.Column('restrict_types', sa.VARCHAR(length=255), autoincrement=False, nullable=True),
    sa.Column('restrict_size', sa.VARCHAR(length=255), autoincrement=False, nullable=True),
    sa.Column('restrict_number', sa.VARCHAR(length=255), autoincrement=False, nullable=True),
    sa.Column('public', sa.BOOLEAN(), autoincrement=False, nullable=True),
    sa.Column('dimensions', sa.VARCHAR(length=255), autoincrement=False, nullable=True),
    sa.Column('responsive_columns', sa.VARCHAR(length=255), autoincrement=False, nullable=True),
    sa.Column('created_at', postgresql.TIMESTAMP(timezone=True), server_default=sa.text('CURRENT_TIMESTAMP'), autoincrement=False, nullable=False),
    sa.Column('updated_at', postgresql.TIMESTAMP(timezone=True), server_default=sa.text('CURRENT_TIMESTAMP'), autoincrement=False, nullable=False),
    sa.Column('meta', sa.TEXT(), autoincrement=False, nullable=True),
    sa.PrimaryKeyConstraint('fk_view_id', name=op.f('nc_gallery_view_v2_pkey'))
    )
    op.create_index(op.f('nc_gallery_view_v2_fk_view_id_index'), 'nc_gallery_view_v2', ['fk_view_id'], unique=False)
    op.create_index(op.f('nc_gallery_view_v2_base_id_index'), 'nc_gallery_view_v2', ['base_id'], unique=False)
    op.create_table('nc_shared_bases',
    sa.Column('id', sa.INTEGER(), autoincrement=True, nullable=False),
    sa.Column('project_id', sa.VARCHAR(length=255), autoincrement=False, nullable=True),
    sa.Column('db_alias', sa.VARCHAR(length=255), autoincrement=False, nullable=True),
    sa.Column('roles', sa.VARCHAR(length=255), server_default=sa.text("'viewer'::character varying"), autoincrement=False, nullable=True),
    sa.Column('shared_base_id', sa.VARCHAR(length=255), autoincrement=False, nullable=True),
    sa.Column('enabled', sa.BOOLEAN(), server_default=sa.text('true'), autoincrement=False, nullable=True),
    sa.Column('password', sa.VARCHAR(length=255), autoincrement=False, nullable=True),
    sa.Column('created_at', postgresql.TIMESTAMP(timezone=True), server_default=sa.text('CURRENT_TIMESTAMP'), autoincrement=False, nullable=False),
    sa.Column('updated_at', postgresql.TIMESTAMP(timezone=True), server_default=sa.text('CURRENT_TIMESTAMP'), autoincrement=False, nullable=False),
    sa.PrimaryKeyConstraint('id', name=op.f('nc_shared_bases_pkey'))
    )
    op.create_table('nc_extensions',
    sa.Column('id', sa.VARCHAR(length=20), autoincrement=False, nullable=False),
    sa.Column('base_id', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('fk_user_id', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('extension_id', sa.VARCHAR(length=255), autoincrement=False, nullable=True),
    sa.Column('title', sa.VARCHAR(length=255), autoincrement=False, nullable=True),
    sa.Column('kv_store', sa.TEXT(), autoincrement=False, nullable=True),
    sa.Column('meta', sa.TEXT(), autoincrement=False, nullable=True),
    sa.Column('order', sa.REAL(), autoincrement=False, nullable=True),
    sa.Column('created_at', postgresql.TIMESTAMP(timezone=True), server_default=sa.text('CURRENT_TIMESTAMP'), autoincrement=False, nullable=False),
    sa.Column('updated_at', postgresql.TIMESTAMP(timezone=True), server_default=sa.text('CURRENT_TIMESTAMP'), autoincrement=False, nullable=False),
    sa.PrimaryKeyConstraint('id', name=op.f('nc_extensions_pkey'))
    )
    op.create_index(op.f('nc_extensions_base_id_index'), 'nc_extensions', ['base_id'], unique=False)
    op.create_table('nc_columns_v2',
    sa.Column('id', sa.VARCHAR(length=20), autoincrement=False, nullable=False),
    sa.Column('source_id', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('base_id', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('fk_model_id', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('title', sa.VARCHAR(length=255), autoincrement=False, nullable=True),
    sa.Column('column_name', sa.VARCHAR(length=255), autoincrement=False, nullable=True),
    sa.Column('uidt', sa.VARCHAR(length=255), autoincrement=False, nullable=True),
    sa.Column('dt', sa.VARCHAR(length=255), autoincrement=False, nullable=True),
    sa.Column('np', sa.VARCHAR(length=255), autoincrement=False, nullable=True),
    sa.Column('ns', sa.VARCHAR(length=255), autoincrement=False, nullable=True),
    sa.Column('clen', sa.VARCHAR(length=255), autoincrement=False, nullable=True),
    sa.Column('cop', sa.VARCHAR(length=255), autoincrement=False, nullable=True),
    sa.Column('pk', sa.BOOLEAN(), autoincrement=False, nullable=True),
    sa.Column('pv', sa.BOOLEAN(), autoincrement=False, nullable=True),
    sa.Column('rqd', sa.BOOLEAN(), autoincrement=False, nullable=True),
    sa.Column('un', sa.BOOLEAN(), autoincrement=False, nullable=True),
    sa.Column('ct', sa.TEXT(), autoincrement=False, nullable=True),
    sa.Column('ai', sa.BOOLEAN(), autoincrement=False, nullable=True),
    sa.Column('unique', sa.BOOLEAN(), autoincrement=False, nullable=True),
    sa.Column('cdf', sa.TEXT(), autoincrement=False, nullable=True),
    sa.Column('cc', sa.TEXT(), autoincrement=False, nullable=True),
    sa.Column('csn', sa.VARCHAR(length=255), autoincrement=False, nullable=True),
    sa.Column('dtx', sa.VARCHAR(length=255), autoincrement=False, nullable=True),
    sa.Column('dtxp', sa.TEXT(), autoincrement=False, nullable=True),
    sa.Column('dtxs', sa.VARCHAR(length=255), autoincrement=False, nullable=True),
    sa.Column('au', sa.BOOLEAN(), autoincrement=False, nullable=True),
    sa.Column('validate', sa.TEXT(), autoincrement=False, nullable=True),
    sa.Column('virtual', sa.BOOLEAN(), autoincrement=False, nullable=True),
    sa.Column('deleted', sa.BOOLEAN(), autoincrement=False, nullable=True),
    sa.Column('system', sa.BOOLEAN(), server_default=sa.text('false'), autoincrement=False, nullable=True),
    sa.Column('order', sa.REAL(), autoincrement=False, nullable=True),
    sa.Column('created_at', postgresql.TIMESTAMP(timezone=True), server_default=sa.text('CURRENT_TIMESTAMP'), autoincrement=False, nullable=False),
    sa.Column('updated_at', postgresql.TIMESTAMP(timezone=True), server_default=sa.text('CURRENT_TIMESTAMP'), autoincrement=False, nullable=False),
    sa.Column('meta', sa.TEXT(), autoincrement=False, nullable=True),
    sa.Column('description', sa.TEXT(), autoincrement=False, nullable=True),
    sa.Column('readonly', sa.BOOLEAN(), server_default=sa.text('false'), autoincrement=False, nullable=True),
    sa.Column('custom_index_name', sa.VARCHAR(length=64), autoincrement=False, nullable=True),
    sa.PrimaryKeyConstraint('id', name=op.f('nc_columns_v2_pkey'))
    )
    op.create_index(op.f('nc_columns_v2_fk_model_id_index'), 'nc_columns_v2', ['fk_model_id'], unique=False)
    op.create_index(op.f('nc_columns_v2_base_id_index'), 'nc_columns_v2', ['base_id'], unique=False)
    op.create_table('nc_orgs_v2',
    sa.Column('id', sa.VARCHAR(length=20), autoincrement=False, nullable=False),
    sa.Column('title', sa.VARCHAR(length=255), autoincrement=False, nullable=True),
    sa.Column('created_at', postgresql.TIMESTAMP(timezone=True), server_default=sa.text('CURRENT_TIMESTAMP'), autoincrement=False, nullable=False),
    sa.Column('updated_at', postgresql.TIMESTAMP(timezone=True), server_default=sa.text('CURRENT_TIMESTAMP'), autoincrement=False, nullable=False),
    sa.PrimaryKeyConstraint('id', name='nc_orgs_v2_pkey'),
    postgresql_ignore_search_path=False
    )
    op.create_table('xc_knex_migrations_lock',
    sa.Column('index', sa.INTEGER(), autoincrement=True, nullable=False),
    sa.Column('is_locked', sa.INTEGER(), autoincrement=False, nullable=True),
    sa.PrimaryKeyConstraint('index', name=op.f('xc_knex_migrations_lock_pkey'))
    )
    op.create_table('nc_col_lookup_v2',
    sa.Column('id', sa.VARCHAR(length=20), autoincrement=False, nullable=False),
    sa.Column('fk_column_id', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('fk_relation_column_id', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('fk_lookup_column_id', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('deleted', sa.BOOLEAN(), autoincrement=False, nullable=True),
    sa.Column('created_at', postgresql.TIMESTAMP(timezone=True), server_default=sa.text('CURRENT_TIMESTAMP'), autoincrement=False, nullable=False),
    sa.Column('updated_at', postgresql.TIMESTAMP(timezone=True), server_default=sa.text('CURRENT_TIMESTAMP'), autoincrement=False, nullable=False),
    sa.Column('base_id', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.PrimaryKeyConstraint('id', name=op.f('nc_col_lookup_v2_pkey'))
    )
    op.create_index(op.f('nc_col_lookup_v2_fk_relation_column_id_index'), 'nc_col_lookup_v2', ['fk_relation_column_id'], unique=False)
    op.create_index(op.f('nc_col_lookup_v2_fk_lookup_column_id_index'), 'nc_col_lookup_v2', ['fk_lookup_column_id'], unique=False)
    op.create_index(op.f('nc_col_lookup_v2_fk_column_id_index'), 'nc_col_lookup_v2', ['fk_column_id'], unique=False)
    op.create_index(op.f('nc_col_lookup_v2_base_id_index'), 'nc_col_lookup_v2', ['base_id'], unique=False)
    op.create_table('nc_form_view_columns_v2',
    sa.Column('id', sa.VARCHAR(length=20), autoincrement=False, nullable=False),
    sa.Column('source_id', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('base_id', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('fk_view_id', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('fk_column_id', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('uuid', sa.VARCHAR(length=255), autoincrement=False, nullable=True),
    sa.Column('label', sa.TEXT(), autoincrement=False, nullable=True),
    sa.Column('help', sa.TEXT(), autoincrement=False, nullable=True),
    sa.Column('description', sa.TEXT(), autoincrement=False, nullable=True),
    sa.Column('required', sa.BOOLEAN(), autoincrement=False, nullable=True),
    sa.Column('show', sa.BOOLEAN(), autoincrement=False, nullable=True),
    sa.Column('order', sa.REAL(), autoincrement=False, nullable=True),
    sa.Column('created_at', postgresql.TIMESTAMP(timezone=True), server_default=sa.text('CURRENT_TIMESTAMP'), autoincrement=False, nullable=False),
    sa.Column('updated_at', postgresql.TIMESTAMP(timezone=True), server_default=sa.text('CURRENT_TIMESTAMP'), autoincrement=False, nullable=False),
    sa.Column('meta', sa.TEXT(), autoincrement=False, nullable=True),
    sa.Column('enable_scanner', sa.BOOLEAN(), autoincrement=False, nullable=True),
    sa.PrimaryKeyConstraint('id', name=op.f('nc_form_view_columns_v2_pkey'))
    )
    op.create_index(op.f('nc_form_view_columns_v2_fk_view_id_index'), 'nc_form_view_columns_v2', ['fk_view_id'], unique=False)
    op.create_index(op.f('nc_form_view_columns_v2_fk_view_id_fk_column_id_index'), 'nc_form_view_columns_v2', ['fk_view_id', 'fk_column_id'], unique=False)
    op.create_index(op.f('nc_form_view_columns_v2_fk_column_id_index'), 'nc_form_view_columns_v2', ['fk_column_id'], unique=False)
    op.create_index(op.f('nc_form_view_columns_v2_base_id_index'), 'nc_form_view_columns_v2', ['base_id'], unique=False)
    op.create_table('nc_kanban_view_columns_v2',
    sa.Column('id', sa.VARCHAR(length=20), autoincrement=False, nullable=False),
    sa.Column('source_id', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('base_id', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('fk_view_id', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('fk_column_id', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('uuid', sa.VARCHAR(length=255), autoincrement=False, nullable=True),
    sa.Column('label', sa.VARCHAR(length=255), autoincrement=False, nullable=True),
    sa.Column('help', sa.VARCHAR(length=255), autoincrement=False, nullable=True),
    sa.Column('show', sa.BOOLEAN(), autoincrement=False, nullable=True),
    sa.Column('order', sa.REAL(), autoincrement=False, nullable=True),
    sa.Column('created_at', postgresql.TIMESTAMP(timezone=True), server_default=sa.text('CURRENT_TIMESTAMP'), autoincrement=False, nullable=False),
    sa.Column('updated_at', postgresql.TIMESTAMP(timezone=True), server_default=sa.text('CURRENT_TIMESTAMP'), autoincrement=False, nullable=False),
    sa.PrimaryKeyConstraint('id', name=op.f('nc_kanban_view_columns_v2_pkey'))
    )
    op.create_index(op.f('nc_kanban_view_columns_v2_fk_view_id_index'), 'nc_kanban_view_columns_v2', ['fk_view_id'], unique=False)
    op.create_index(op.f('nc_kanban_view_columns_v2_fk_view_id_fk_column_id_index'), 'nc_kanban_view_columns_v2', ['fk_view_id', 'fk_column_id'], unique=False)
    op.create_index(op.f('nc_kanban_view_columns_v2_fk_column_id_index'), 'nc_kanban_view_columns_v2', ['fk_column_id'], unique=False)
    op.create_index(op.f('nc_kanban_view_columns_v2_base_id_index'), 'nc_kanban_view_columns_v2', ['base_id'], unique=False)
    op.create_table('nc_filter_exp_v2',
    sa.Column('id', sa.VARCHAR(length=20), autoincrement=False, nullable=False),
    sa.Column('source_id', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('base_id', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('fk_view_id', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('fk_hook_id', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('fk_column_id', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('fk_parent_id', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('logical_op', sa.VARCHAR(length=255), autoincrement=False, nullable=True),
    sa.Column('comparison_op', sa.VARCHAR(length=255), autoincrement=False, nullable=True),
    sa.Column('value', sa.TEXT(), autoincrement=False, nullable=True),
    sa.Column('is_group', sa.BOOLEAN(), autoincrement=False, nullable=True),
    sa.Column('order', sa.REAL(), autoincrement=False, nullable=True),
    sa.Column('created_at', postgresql.TIMESTAMP(timezone=True), server_default=sa.text('CURRENT_TIMESTAMP'), autoincrement=False, nullable=False),
    sa.Column('updated_at', postgresql.TIMESTAMP(timezone=True), server_default=sa.text('CURRENT_TIMESTAMP'), autoincrement=False, nullable=False),
    sa.Column('comparison_sub_op', sa.VARCHAR(length=255), autoincrement=False, nullable=True),
    sa.Column('fk_link_col_id', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('fk_value_col_id', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('fk_parent_column_id', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('fk_row_color_condition_id', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('fk_widget_id', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.PrimaryKeyConstraint('id', name=op.f('nc_filter_exp_v2_pkey'))
    )
    op.create_index(op.f('nc_filter_exp_v2_fk_widget_id_index'), 'nc_filter_exp_v2', ['fk_widget_id'], unique=False)
    op.create_index(op.f('nc_filter_exp_v2_fk_view_id_index'), 'nc_filter_exp_v2', ['fk_view_id'], unique=False)
    op.create_index(op.f('nc_filter_exp_v2_fk_value_col_id_index'), 'nc_filter_exp_v2', ['fk_value_col_id'], unique=False)
    op.create_index(op.f('nc_filter_exp_v2_fk_parent_id_index'), 'nc_filter_exp_v2', ['fk_parent_id'], unique=False)
    op.create_index(op.f('nc_filter_exp_v2_fk_parent_column_id_index'), 'nc_filter_exp_v2', ['fk_parent_column_id'], unique=False)
    op.create_index(op.f('nc_filter_exp_v2_fk_link_col_id_index'), 'nc_filter_exp_v2', ['fk_link_col_id'], unique=False)
    op.create_index(op.f('nc_filter_exp_v2_fk_hook_id_index'), 'nc_filter_exp_v2', ['fk_hook_id'], unique=False)
    op.create_index(op.f('nc_filter_exp_v2_fk_column_id_index'), 'nc_filter_exp_v2', ['fk_column_id'], unique=False)
    op.create_index(op.f('nc_filter_exp_v2_base_id_index'), 'nc_filter_exp_v2', ['base_id'], unique=False)
    op.create_table('nc_views_v2',
    sa.Column('id', sa.VARCHAR(length=20), autoincrement=False, nullable=False),
    sa.Column('source_id', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('base_id', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('fk_model_id', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('title', sa.VARCHAR(length=255), autoincrement=False, nullable=True),
    sa.Column('type', sa.INTEGER(), autoincrement=False, nullable=True),
    sa.Column('is_default', sa.BOOLEAN(), autoincrement=False, nullable=True),
    sa.Column('show_system_fields', sa.BOOLEAN(), autoincrement=False, nullable=True),
    sa.Column('lock_type', sa.VARCHAR(length=255), server_default=sa.text("'collaborative'::character varying"), autoincrement=False, nullable=True),
    sa.Column('uuid', sa.VARCHAR(length=255), autoincrement=False, nullable=True),
    sa.Column('password', sa.VARCHAR(length=255), autoincrement=False, nullable=True),
    sa.Column('show', sa.BOOLEAN(), autoincrement=False, nullable=True),
    sa.Column('order', sa.REAL(), autoincrement=False, nullable=True),
    sa.Column('created_at', postgresql.TIMESTAMP(timezone=True), server_default=sa.text('CURRENT_TIMESTAMP'), autoincrement=False, nullable=False),
    sa.Column('updated_at', postgresql.TIMESTAMP(timezone=True), server_default=sa.text('CURRENT_TIMESTAMP'), autoincrement=False, nullable=False),
    sa.Column('meta', sa.TEXT(), autoincrement=False, nullable=True),
    sa.Column('description', sa.TEXT(), autoincrement=False, nullable=True),
    sa.Column('created_by', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('owned_by', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('row_coloring_mode', sa.VARCHAR(length=10), autoincrement=False, nullable=True),
    sa.PrimaryKeyConstraint('id', name=op.f('nc_views_v2_pkey'))
    )
    op.create_index(op.f('nc_views_v2_owned_by_index'), 'nc_views_v2', ['owned_by'], unique=False)
    op.create_index(op.f('nc_views_v2_fk_model_id_index'), 'nc_views_v2', ['fk_model_id'], unique=False)
    op.create_index(op.f('nc_views_v2_created_by_index'), 'nc_views_v2', ['created_by'], unique=False)
    op.create_index(op.f('nc_views_v2_base_id_index'), 'nc_views_v2', ['base_id'], unique=False)
    op.create_table('nc_mcp_tokens',
    sa.Column('id', sa.VARCHAR(length=20), autoincrement=False, nullable=False),
    sa.Column('title', sa.VARCHAR(length=512), autoincrement=False, nullable=True),
    sa.Column('base_id', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('token', sa.VARCHAR(length=32), autoincrement=False, nullable=True),
    sa.Column('fk_workspace_id', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('order', sa.REAL(), autoincrement=False, nullable=True),
    sa.Column('fk_user_id', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('created_at', postgresql.TIMESTAMP(timezone=True), server_default=sa.text('CURRENT_TIMESTAMP'), autoincrement=False, nullable=False),
    sa.Column('updated_at', postgresql.TIMESTAMP(timezone=True), server_default=sa.text('CURRENT_TIMESTAMP'), autoincrement=False, nullable=False),
    sa.PrimaryKeyConstraint('id', name=op.f('nc_mcp_tokens_pkey'))
    )
    op.create_index(op.f('nc_mc_tokens_context'), 'nc_mcp_tokens', ['base_id', 'fk_workspace_id'], unique=False)
    op.create_table('nc_col_formula_v2',
    sa.Column('id', sa.VARCHAR(length=20), autoincrement=False, nullable=False),
    sa.Column('fk_column_id', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('formula', sa.TEXT(), autoincrement=False, nullable=False),
    sa.Column('formula_raw', sa.TEXT(), autoincrement=False, nullable=True),
    sa.Column('error', sa.TEXT(), autoincrement=False, nullable=True),
    sa.Column('deleted', sa.BOOLEAN(), autoincrement=False, nullable=True),
    sa.Column('order', sa.REAL(), autoincrement=False, nullable=True),
    sa.Column('created_at', postgresql.TIMESTAMP(timezone=True), server_default=sa.text('CURRENT_TIMESTAMP'), autoincrement=False, nullable=False),
    sa.Column('updated_at', postgresql.TIMESTAMP(timezone=True), server_default=sa.text('CURRENT_TIMESTAMP'), autoincrement=False, nullable=False),
    sa.Column('parsed_tree', sa.TEXT(), autoincrement=False, nullable=True),
    sa.Column('base_id', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.PrimaryKeyConstraint('id', name=op.f('nc_col_formula_v2_pkey'))
    )
    op.create_index(op.f('nc_col_formula_v2_fk_column_id_index'), 'nc_col_formula_v2', ['fk_column_id'], unique=False)
    op.create_index(op.f('nc_col_formula_v2_base_id_index'), 'nc_col_formula_v2', ['base_id'], unique=False)
    op.create_table('nc_grid_view_v2',
    sa.Column('fk_view_id', sa.VARCHAR(length=20), autoincrement=False, nullable=False),
    sa.Column('source_id', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('base_id', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('uuid', sa.VARCHAR(length=255), autoincrement=False, nullable=True),
    sa.Column('created_at', postgresql.TIMESTAMP(timezone=True), server_default=sa.text('CURRENT_TIMESTAMP'), autoincrement=False, nullable=False),
    sa.Column('updated_at', postgresql.TIMESTAMP(timezone=True), server_default=sa.text('CURRENT_TIMESTAMP'), autoincrement=False, nullable=False),
    sa.Column('meta', sa.TEXT(), autoincrement=False, nullable=True),
    sa.Column('row_height', sa.INTEGER(), autoincrement=False, nullable=True),
    sa.PrimaryKeyConstraint('fk_view_id', name=op.f('nc_grid_view_v2_pkey'))
    )
    op.create_index(op.f('nc_grid_view_v2_fk_view_id_index'), 'nc_grid_view_v2', ['fk_view_id'], unique=False)
    op.create_index(op.f('nc_grid_view_v2_base_id_index'), 'nc_grid_view_v2', ['base_id'], unique=False)
    op.create_table('nc_users_v2',
    sa.Column('id', sa.VARCHAR(length=20), autoincrement=False, nullable=False),
    sa.Column('email', sa.VARCHAR(length=255), autoincrement=False, nullable=True),
    sa.Column('password', sa.VARCHAR(length=255), autoincrement=False, nullable=True),
    sa.Column('salt', sa.VARCHAR(length=255), autoincrement=False, nullable=True),
    sa.Column('invite_token', sa.VARCHAR(length=255), autoincrement=False, nullable=True),
    sa.Column('invite_token_expires', sa.VARCHAR(length=255), autoincrement=False, nullable=True),
    sa.Column('reset_password_expires', postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=True),
    sa.Column('reset_password_token', sa.VARCHAR(length=255), autoincrement=False, nullable=True),
    sa.Column('email_verification_token', sa.VARCHAR(length=255), autoincrement=False, nullable=True),
    sa.Column('email_verified', sa.BOOLEAN(), autoincrement=False, nullable=True),
    sa.Column('roles', sa.VARCHAR(length=255), server_default=sa.text("'editor'::character varying"), autoincrement=False, nullable=True),
    sa.Column('created_at', postgresql.TIMESTAMP(timezone=True), server_default=sa.text('CURRENT_TIMESTAMP'), autoincrement=False, nullable=False),
    sa.Column('updated_at', postgresql.TIMESTAMP(timezone=True), server_default=sa.text('CURRENT_TIMESTAMP'), autoincrement=False, nullable=False),
    sa.Column('token_version', sa.VARCHAR(length=255), autoincrement=False, nullable=True),
    sa.Column('display_name', sa.VARCHAR(length=255), autoincrement=False, nullable=True),
    sa.Column('user_name', sa.VARCHAR(length=255), autoincrement=False, nullable=True),
    sa.Column('blocked', sa.BOOLEAN(), server_default=sa.text('false'), autoincrement=False, nullable=True),
    sa.Column('blocked_reason', sa.VARCHAR(length=255), autoincrement=False, nullable=True),
    sa.Column('deleted_at', postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=True),
    sa.Column('is_deleted', sa.BOOLEAN(), server_default=sa.text('false'), autoincrement=False, nullable=True),
    sa.Column('meta', sa.TEXT(), autoincrement=False, nullable=True),
    sa.Column('is_new_user', sa.BOOLEAN(), autoincrement=False, nullable=True),
    sa.PrimaryKeyConstraint('id', name='nc_users_v2_pkey'),
    postgresql_ignore_search_path=False
    )
    op.create_index(op.f('nc_users_v2_email_index'), 'nc_users_v2', ['email'], unique=False)
    op.create_table('nc_col_button_v2',
    sa.Column('id', sa.VARCHAR(length=20), autoincrement=False, nullable=False),
    sa.Column('base_id', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('type', sa.VARCHAR(length=255), autoincrement=False, nullable=True),
    sa.Column('label', sa.TEXT(), autoincrement=False, nullable=True),
    sa.Column('theme', sa.VARCHAR(length=255), autoincrement=False, nullable=True),
    sa.Column('color', sa.VARCHAR(length=255), autoincrement=False, nullable=True),
    sa.Column('icon', sa.VARCHAR(length=255), autoincrement=False, nullable=True),
    sa.Column('formula', sa.TEXT(), autoincrement=False, nullable=True),
    sa.Column('formula_raw', sa.TEXT(), autoincrement=False, nullable=True),
    sa.Column('error', sa.VARCHAR(length=255), autoincrement=False, nullable=True),
    sa.Column('parsed_tree', sa.TEXT(), autoincrement=False, nullable=True),
    sa.Column('fk_webhook_id', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('fk_column_id', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('created_at', postgresql.TIMESTAMP(timezone=True), server_default=sa.text('CURRENT_TIMESTAMP'), autoincrement=False, nullable=False),
    sa.Column('updated_at', postgresql.TIMESTAMP(timezone=True), server_default=sa.text('CURRENT_TIMESTAMP'), autoincrement=False, nullable=False),
    sa.Column('fk_integration_id', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('model', sa.VARCHAR(length=255), autoincrement=False, nullable=True),
    sa.Column('output_column_ids', sa.TEXT(), autoincrement=False, nullable=True),
    sa.Column('fk_workspace_id', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.PrimaryKeyConstraint('id', name=op.f('nc_col_button_v2_pkey'))
    )
    op.create_index(op.f('nc_col_button_v2_fk_column_id_index'), 'nc_col_button_v2', ['fk_column_id'], unique=False)
    op.create_index(op.f('nc_col_button_context'), 'nc_col_button_v2', ['base_id', 'fk_workspace_id'], unique=False)
    op.create_table('nc_comment_reactions',
    sa.Column('id', sa.VARCHAR(length=20), autoincrement=False, nullable=False),
    sa.Column('row_id', sa.VARCHAR(length=255), autoincrement=False, nullable=True),
    sa.Column('comment_id', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('source_id', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('fk_model_id', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('base_id', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('reaction', sa.VARCHAR(length=255), autoincrement=False, nullable=True),
    sa.Column('created_by', sa.VARCHAR(length=255), autoincrement=False, nullable=True),
    sa.Column('created_at', postgresql.TIMESTAMP(timezone=True), server_default=sa.text('CURRENT_TIMESTAMP'), autoincrement=False, nullable=False),
    sa.Column('updated_at', postgresql.TIMESTAMP(timezone=True), server_default=sa.text('CURRENT_TIMESTAMP'), autoincrement=False, nullable=False),
    sa.PrimaryKeyConstraint('id', name=op.f('nc_comment_reactions_pkey'))
    )
    op.create_index(op.f('nc_comment_reactions_row_id_index'), 'nc_comment_reactions', ['row_id'], unique=False)
    op.create_index(op.f('nc_comment_reactions_comment_id_index'), 'nc_comment_reactions', ['comment_id'], unique=False)
    op.create_index(op.f('nc_comment_reactions_base_id_index'), 'nc_comment_reactions', ['base_id'], unique=False)
    op.create_table('nc_comments',
    sa.Column('id', sa.VARCHAR(length=20), autoincrement=False, nullable=False),
    sa.Column('row_id', sa.VARCHAR(length=255), autoincrement=False, nullable=True),
    sa.Column('comment', sa.TEXT(), autoincrement=False, nullable=True),
    sa.Column('created_by', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('created_by_email', sa.VARCHAR(length=255), autoincrement=False, nullable=True),
    sa.Column('resolved_by', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('resolved_by_email', sa.VARCHAR(length=255), autoincrement=False, nullable=True),
    sa.Column('parent_comment_id', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('source_id', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('base_id', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('fk_model_id', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('is_deleted', sa.BOOLEAN(), autoincrement=False, nullable=True),
    sa.Column('created_at', postgresql.TIMESTAMP(timezone=True), server_default=sa.text('CURRENT_TIMESTAMP'), autoincrement=False, nullable=False),
    sa.Column('updated_at', postgresql.TIMESTAMP(timezone=True), server_default=sa.text('CURRENT_TIMESTAMP'), autoincrement=False, nullable=False),
    sa.PrimaryKeyConstraint('id', name=op.f('nc_comments_pkey'))
    )
    op.create_index(op.f('nc_comments_row_id_fk_model_id_index'), 'nc_comments', ['row_id', 'fk_model_id'], unique=False)
    op.create_index(op.f('nc_comments_base_id_index'), 'nc_comments', ['base_id'], unique=False)
    op.create_table('nc_teams_v2',
    sa.Column('id', sa.VARCHAR(length=20), autoincrement=False, nullable=False),
    sa.Column('title', sa.VARCHAR(length=255), autoincrement=False, nullable=True),
    sa.Column('org_id', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('created_at', postgresql.TIMESTAMP(timezone=True), server_default=sa.text('CURRENT_TIMESTAMP'), autoincrement=False, nullable=False),
    sa.Column('updated_at', postgresql.TIMESTAMP(timezone=True), server_default=sa.text('CURRENT_TIMESTAMP'), autoincrement=False, nullable=False),
    sa.ForeignKeyConstraint(['org_id'], ['nc_orgs_v2.id'], name=op.f('nc_teams_v2_org_id_foreign')),
    sa.PrimaryKeyConstraint('id', name=op.f('nc_teams_v2_pkey'))
    )
    op.create_table('nc_col_barcode_v2',
    sa.Column('id', sa.VARCHAR(length=20), autoincrement=False, nullable=False),
    sa.Column('fk_column_id', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('fk_barcode_value_column_id', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('barcode_format', sa.VARCHAR(length=15), autoincrement=False, nullable=True),
    sa.Column('deleted', sa.BOOLEAN(), autoincrement=False, nullable=True),
    sa.Column('created_at', postgresql.TIMESTAMP(timezone=True), server_default=sa.text('CURRENT_TIMESTAMP'), autoincrement=False, nullable=False),
    sa.Column('updated_at', postgresql.TIMESTAMP(timezone=True), server_default=sa.text('CURRENT_TIMESTAMP'), autoincrement=False, nullable=False),
    sa.Column('base_id', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.PrimaryKeyConstraint('id', name=op.f('nc_col_barcode_v2_pkey'))
    )
    op.create_index(op.f('nc_col_barcode_v2_fk_column_id_index'), 'nc_col_barcode_v2', ['fk_column_id'], unique=False)
    op.create_index(op.f('nc_col_barcode_v2_base_id_index'), 'nc_col_barcode_v2', ['base_id'], unique=False)
    op.create_table('nc_col_qrcode_v2',
    sa.Column('id', sa.VARCHAR(length=20), autoincrement=False, nullable=False),
    sa.Column('fk_column_id', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('fk_qr_value_column_id', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('deleted', sa.BOOLEAN(), autoincrement=False, nullable=True),
    sa.Column('order', sa.REAL(), autoincrement=False, nullable=True),
    sa.Column('created_at', postgresql.TIMESTAMP(timezone=True), server_default=sa.text('CURRENT_TIMESTAMP'), autoincrement=False, nullable=False),
    sa.Column('updated_at', postgresql.TIMESTAMP(timezone=True), server_default=sa.text('CURRENT_TIMESTAMP'), autoincrement=False, nullable=False),
    sa.Column('base_id', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.PrimaryKeyConstraint('id', name=op.f('nc_col_qrcode_v2_pkey'))
    )
    op.create_index(op.f('nc_col_qrcode_v2_fk_column_id_index'), 'nc_col_qrcode_v2', ['fk_column_id'], unique=False)
    op.create_index(op.f('nc_col_qrcode_v2_base_id_index'), 'nc_col_qrcode_v2', ['base_id'], unique=False)
    op.create_table('nc_sync_mappings',
    sa.Column('id', sa.VARCHAR(length=20), autoincrement=False, nullable=False),
    sa.Column('fk_workspace_id', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('base_id', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('fk_sync_config_id', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('target_table', sa.VARCHAR(length=255), autoincrement=False, nullable=True),
    sa.Column('fk_model_id', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('created_at', postgresql.TIMESTAMP(timezone=True), server_default=sa.text('CURRENT_TIMESTAMP'), autoincrement=False, nullable=False),
    sa.Column('updated_at', postgresql.TIMESTAMP(timezone=True), server_default=sa.text('CURRENT_TIMESTAMP'), autoincrement=False, nullable=False),
    sa.PrimaryKeyConstraint('id', name=op.f('nc_sync_mappings_pkey'))
    )
    op.create_index(op.f('nc_sync_mappings_sync_config_idx'), 'nc_sync_mappings', ['fk_sync_config_id'], unique=False)
    op.create_index(op.f('nc_sync_mappings_context'), 'nc_sync_mappings', ['base_id', 'fk_workspace_id'], unique=False)
    op.create_table('nc_user_refresh_tokens',
    sa.Column('fk_user_id', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('token', sa.VARCHAR(length=255), autoincrement=False, nullable=True),
    sa.Column('meta', sa.TEXT(), autoincrement=False, nullable=True),
    sa.Column('expires_at', postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=True),
    sa.Column('created_at', postgresql.TIMESTAMP(timezone=True), server_default=sa.text('CURRENT_TIMESTAMP'), autoincrement=False, nullable=False),
    sa.Column('updated_at', postgresql.TIMESTAMP(timezone=True), server_default=sa.text('CURRENT_TIMESTAMP'), autoincrement=False, nullable=False)
    )
    op.create_index(op.f('nc_user_refresh_tokens_token_index'), 'nc_user_refresh_tokens', ['token'], unique=False)
    op.create_index(op.f('nc_user_refresh_tokens_fk_user_id_index'), 'nc_user_refresh_tokens', ['fk_user_id'], unique=False)
    op.create_index(op.f('nc_user_refresh_tokens_expires_at_index'), 'nc_user_refresh_tokens', ['expires_at'], unique=False)
    op.create_table('nc_col_rollup_v2',
    sa.Column('id', sa.VARCHAR(length=20), autoincrement=False, nullable=False),
    sa.Column('fk_column_id', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('fk_relation_column_id', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('fk_rollup_column_id', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('rollup_function', sa.VARCHAR(length=255), autoincrement=False, nullable=True),
    sa.Column('deleted', sa.BOOLEAN(), autoincrement=False, nullable=True),
    sa.Column('created_at', postgresql.TIMESTAMP(timezone=True), server_default=sa.text('CURRENT_TIMESTAMP'), autoincrement=False, nullable=False),
    sa.Column('updated_at', postgresql.TIMESTAMP(timezone=True), server_default=sa.text('CURRENT_TIMESTAMP'), autoincrement=False, nullable=False),
    sa.Column('base_id', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.PrimaryKeyConstraint('id', name=op.f('nc_col_rollup_v2_pkey'))
    )
    op.create_index(op.f('nc_col_rollup_v2_fk_rollup_column_id_index'), 'nc_col_rollup_v2', ['fk_rollup_column_id'], unique=False)
    op.create_index(op.f('nc_col_rollup_v2_fk_relation_column_id_index'), 'nc_col_rollup_v2', ['fk_relation_column_id'], unique=False)
    op.create_index(op.f('nc_col_rollup_v2_fk_column_id_index'), 'nc_col_rollup_v2', ['fk_column_id'], unique=False)
    op.create_index(op.f('nc_col_rollup_v2_base_id_index'), 'nc_col_rollup_v2', ['base_id'], unique=False)
    op.create_table('nc_gallery_view_columns_v2',
    sa.Column('id', sa.VARCHAR(length=20), autoincrement=False, nullable=False),
    sa.Column('source_id', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('base_id', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('fk_view_id', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('fk_column_id', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('uuid', sa.VARCHAR(length=255), autoincrement=False, nullable=True),
    sa.Column('label', sa.VARCHAR(length=255), autoincrement=False, nullable=True),
    sa.Column('help', sa.VARCHAR(length=255), autoincrement=False, nullable=True),
    sa.Column('show', sa.BOOLEAN(), autoincrement=False, nullable=True),
    sa.Column('order', sa.REAL(), autoincrement=False, nullable=True),
    sa.Column('created_at', postgresql.TIMESTAMP(timezone=True), server_default=sa.text('CURRENT_TIMESTAMP'), autoincrement=False, nullable=False),
    sa.Column('updated_at', postgresql.TIMESTAMP(timezone=True), server_default=sa.text('CURRENT_TIMESTAMP'), autoincrement=False, nullable=False),
    sa.PrimaryKeyConstraint('id', name=op.f('nc_gallery_view_columns_v2_pkey'))
    )
    op.create_index(op.f('nc_gallery_view_columns_v2_fk_view_id_index'), 'nc_gallery_view_columns_v2', ['fk_view_id'], unique=False)
    op.create_index(op.f('nc_gallery_view_columns_v2_fk_view_id_fk_column_id_index'), 'nc_gallery_view_columns_v2', ['fk_view_id', 'fk_column_id'], unique=False)
    op.create_index(op.f('nc_gallery_view_columns_v2_fk_column_id_index'), 'nc_gallery_view_columns_v2', ['fk_column_id'], unique=False)
    op.create_index(op.f('nc_gallery_view_columns_v2_base_id_index'), 'nc_gallery_view_columns_v2', ['base_id'], unique=False)
    op.create_table('nc_form_view_v2',
    sa.Column('source_id', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('base_id', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('fk_view_id', sa.VARCHAR(length=20), autoincrement=False, nullable=False),
    sa.Column('heading', sa.VARCHAR(length=255), autoincrement=False, nullable=True),
    sa.Column('subheading', sa.TEXT(), autoincrement=False, nullable=True),
    sa.Column('success_msg', sa.TEXT(), autoincrement=False, nullable=True),
    sa.Column('redirect_url', sa.TEXT(), autoincrement=False, nullable=True),
    sa.Column('redirect_after_secs', sa.VARCHAR(length=255), autoincrement=False, nullable=True),
    sa.Column('email', sa.VARCHAR(length=255), autoincrement=False, nullable=True),
    sa.Column('submit_another_form', sa.BOOLEAN(), autoincrement=False, nullable=True),
    sa.Column('show_blank_form', sa.BOOLEAN(), autoincrement=False, nullable=True),
    sa.Column('uuid', sa.VARCHAR(length=255), autoincrement=False, nullable=True),
    sa.Column('banner_image_url', sa.TEXT(), autoincrement=False, nullable=True),
    sa.Column('logo_url', sa.TEXT(), autoincrement=False, nullable=True),
    sa.Column('created_at', postgresql.TIMESTAMP(timezone=True), server_default=sa.text('CURRENT_TIMESTAMP'), autoincrement=False, nullable=False),
    sa.Column('updated_at', postgresql.TIMESTAMP(timezone=True), server_default=sa.text('CURRENT_TIMESTAMP'), autoincrement=False, nullable=False),
    sa.Column('meta', sa.TEXT(), autoincrement=False, nullable=True),
    sa.PrimaryKeyConstraint('fk_view_id', name=op.f('nc_form_view_v2_pkey'))
    )
    op.create_index(op.f('nc_form_view_v2_fk_view_id_index'), 'nc_form_view_v2', ['fk_view_id'], unique=False)
    op.create_index(op.f('nc_form_view_v2_base_id_index'), 'nc_form_view_v2', ['base_id'], unique=False)
    op.create_table('nc_jobs',
    sa.Column('id', sa.VARCHAR(length=20), autoincrement=False, nullable=False),
    sa.Column('job', sa.VARCHAR(length=255), autoincrement=False, nullable=True),
    sa.Column('status', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('result', sa.TEXT(), autoincrement=False, nullable=True),
    sa.Column('fk_user_id', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('fk_workspace_id', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('base_id', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('created_at', postgresql.TIMESTAMP(timezone=True), server_default=sa.text('CURRENT_TIMESTAMP'), autoincrement=False, nullable=False),
    sa.Column('updated_at', postgresql.TIMESTAMP(timezone=True), server_default=sa.text('CURRENT_TIMESTAMP'), autoincrement=False, nullable=False),
    sa.PrimaryKeyConstraint('id', name=op.f('nc_jobs_pkey'))
    )
    op.create_index(op.f('nc_jobs_context'), 'nc_jobs', ['base_id', 'fk_workspace_id'], unique=False)
    op.create_table('nc_plugins_v2',
    sa.Column('id', sa.VARCHAR(length=20), autoincrement=False, nullable=False),
    sa.Column('title', sa.VARCHAR(length=45), autoincrement=False, nullable=True),
    sa.Column('description', sa.TEXT(), autoincrement=False, nullable=True),
    sa.Column('active', sa.BOOLEAN(), server_default=sa.text('false'), autoincrement=False, nullable=True),
    sa.Column('rating', sa.REAL(), autoincrement=False, nullable=True),
    sa.Column('version', sa.VARCHAR(length=255), autoincrement=False, nullable=True),
    sa.Column('docs', sa.VARCHAR(length=255), autoincrement=False, nullable=True),
    sa.Column('status', sa.VARCHAR(length=255), server_default=sa.text("'install'::character varying"), autoincrement=False, nullable=True),
    sa.Column('status_details', sa.VARCHAR(length=255), autoincrement=False, nullable=True),
    sa.Column('logo', sa.VARCHAR(length=255), autoincrement=False, nullable=True),
    sa.Column('icon', sa.VARCHAR(length=255), autoincrement=False, nullable=True),
    sa.Column('tags', sa.VARCHAR(length=255), autoincrement=False, nullable=True),
    sa.Column('category', sa.VARCHAR(length=255), autoincrement=False, nullable=True),
    sa.Column('input_schema', sa.TEXT(), autoincrement=False, nullable=True),
    sa.Column('input', sa.TEXT(), autoincrement=False, nullable=True),
    sa.Column('creator', sa.VARCHAR(length=255), autoincrement=False, nullable=True),
    sa.Column('creator_website', sa.VARCHAR(length=255), autoincrement=False, nullable=True),
    sa.Column('price', sa.VARCHAR(length=255), autoincrement=False, nullable=True),
    sa.Column('created_at', postgresql.TIMESTAMP(timezone=True), server_default=sa.text('CURRENT_TIMESTAMP'), autoincrement=False, nullable=False),
    sa.Column('updated_at', postgresql.TIMESTAMP(timezone=True), server_default=sa.text('CURRENT_TIMESTAMP'), autoincrement=False, nullable=False),
    sa.PrimaryKeyConstraint('id', name=op.f('nc_plugins_v2_pkey'))
    )
    op.create_table('nc_file_references',
    sa.Column('id', sa.VARCHAR(length=20), autoincrement=False, nullable=False),
    sa.Column('storage', sa.VARCHAR(length=255), autoincrement=False, nullable=True),
    sa.Column('file_url', sa.TEXT(), autoincrement=False, nullable=True),
    sa.Column('file_size', sa.INTEGER(), autoincrement=False, nullable=True),
    sa.Column('fk_user_id', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('fk_workspace_id', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('base_id', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('source_id', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('fk_model_id', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('fk_column_id', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('is_external', sa.BOOLEAN(), server_default=sa.text('false'), autoincrement=False, nullable=True),
    sa.Column('deleted', sa.BOOLEAN(), server_default=sa.text('false'), autoincrement=False, nullable=True),
    sa.Column('created_at', postgresql.TIMESTAMP(timezone=True), server_default=sa.text('CURRENT_TIMESTAMP'), autoincrement=False, nullable=False),
    sa.Column('updated_at', postgresql.TIMESTAMP(timezone=True), server_default=sa.text('CURRENT_TIMESTAMP'), autoincrement=False, nullable=False),
    sa.PrimaryKeyConstraint('id', name=op.f('nc_file_references_pkey'))
    )
    op.create_index(op.f('nc_fr_context'), 'nc_file_references', ['base_id', 'fk_workspace_id'], unique=False)
    op.create_table('xc_knex_migrations',
    sa.Column('id', sa.INTEGER(), autoincrement=True, nullable=False),
    sa.Column('name', sa.VARCHAR(length=255), autoincrement=False, nullable=True),
    sa.Column('batch', sa.INTEGER(), autoincrement=False, nullable=True),
    sa.Column('migration_time', postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=True),
    sa.PrimaryKeyConstraint('id', name=op.f('xc_knex_migrations_pkey'))
    )
    op.create_table('nc_data_reflection',
    sa.Column('id', sa.VARCHAR(length=20), autoincrement=False, nullable=False),
    sa.Column('fk_workspace_id', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('username', sa.VARCHAR(length=255), autoincrement=False, nullable=True),
    sa.Column('password', sa.VARCHAR(length=255), autoincrement=False, nullable=True),
    sa.Column('database', sa.VARCHAR(length=255), autoincrement=False, nullable=True),
    sa.Column('created_at', postgresql.TIMESTAMP(timezone=True), server_default=sa.text('CURRENT_TIMESTAMP'), autoincrement=False, nullable=False),
    sa.Column('updated_at', postgresql.TIMESTAMP(timezone=True), server_default=sa.text('CURRENT_TIMESTAMP'), autoincrement=False, nullable=False),
    sa.PrimaryKeyConstraint('id', name=op.f('nc_data_reflection_pkey'))
    )
    op.create_index(op.f('nc_data_reflection_fk_workspace_id_index'), 'nc_data_reflection', ['fk_workspace_id'], unique=False)
    op.create_table('nc_row_color_conditions',
    sa.Column('id', sa.VARCHAR(length=20), autoincrement=False, nullable=False),
    sa.Column('fk_view_id', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('fk_workspace_id', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('base_id', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('color', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('nc_order', sa.INTEGER(), autoincrement=False, nullable=True),
    sa.Column('is_set_as_background', sa.BOOLEAN(), autoincrement=False, nullable=True),
    sa.Column('created_at', postgresql.TIMESTAMP(timezone=True), server_default=sa.text('CURRENT_TIMESTAMP'), autoincrement=False, nullable=False),
    sa.Column('updated_at', postgresql.TIMESTAMP(timezone=True), server_default=sa.text('CURRENT_TIMESTAMP'), autoincrement=False, nullable=False),
    sa.PrimaryKeyConstraint('id', name=op.f('nc_row_color_conditions_pkey'))
    )
    op.create_index(op.f('nc_row_color_conditions_fk_workspace_id_base_id_index'), 'nc_row_color_conditions', ['fk_workspace_id', 'base_id'], unique=False)
    op.create_index(op.f('nc_row_color_conditions_fk_view_id_index'), 'nc_row_color_conditions', ['fk_view_id'], unique=False)
    op.create_table('notification',
    sa.Column('id', sa.VARCHAR(length=20), autoincrement=False, nullable=False),
    sa.Column('type', sa.VARCHAR(length=40), autoincrement=False, nullable=True),
    sa.Column('body', sa.TEXT(), autoincrement=False, nullable=True),
    sa.Column('is_read', sa.BOOLEAN(), server_default=sa.text('false'), autoincrement=False, nullable=True),
    sa.Column('is_deleted', sa.BOOLEAN(), server_default=sa.text('false'), autoincrement=False, nullable=True),
    sa.Column('fk_user_id', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('created_at', postgresql.TIMESTAMP(timezone=True), server_default=sa.text('CURRENT_TIMESTAMP'), autoincrement=False, nullable=False),
    sa.Column('updated_at', postgresql.TIMESTAMP(timezone=True), server_default=sa.text('CURRENT_TIMESTAMP'), autoincrement=False, nullable=False),
    sa.PrimaryKeyConstraint('id', name=op.f('notification_pkey'))
    )
    op.create_index(op.f('notification_fk_user_id_index'), 'notification', ['fk_user_id'], unique=False)
    op.create_index(op.f('notification_created_at_index'), 'notification', ['created_at'], unique=False)
    op.create_table('nc_team_users_v2',
    sa.Column('org_id', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('user_id', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('created_at', postgresql.TIMESTAMP(timezone=True), server_default=sa.text('CURRENT_TIMESTAMP'), autoincrement=False, nullable=False),
    sa.Column('updated_at', postgresql.TIMESTAMP(timezone=True), server_default=sa.text('CURRENT_TIMESTAMP'), autoincrement=False, nullable=False),
    sa.ForeignKeyConstraint(['org_id'], ['nc_orgs_v2.id'], name=op.f('nc_team_users_v2_org_id_foreign')),
    sa.ForeignKeyConstraint(['user_id'], ['nc_users_v2.id'], name=op.f('nc_team_users_v2_user_id_foreign'))
    )
    op.create_table('nc_integrations_store_v2',
    sa.Column('id', sa.VARCHAR(length=20), autoincrement=False, nullable=False),
    sa.Column('fk_integration_id', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('type', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('sub_type', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('fk_workspace_id', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('fk_user_id', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('created_at', postgresql.TIMESTAMP(timezone=True), server_default=sa.text('CURRENT_TIMESTAMP'), autoincrement=False, nullable=False),
    sa.Column('updated_at', postgresql.TIMESTAMP(timezone=True), server_default=sa.text('CURRENT_TIMESTAMP'), autoincrement=False, nullable=False),
    sa.Column('slot_0', sa.TEXT(), autoincrement=False, nullable=True),
    sa.Column('slot_1', sa.TEXT(), autoincrement=False, nullable=True),
    sa.Column('slot_2', sa.TEXT(), autoincrement=False, nullable=True),
    sa.Column('slot_3', sa.TEXT(), autoincrement=False, nullable=True),
    sa.Column('slot_4', sa.TEXT(), autoincrement=False, nullable=True),
    sa.Column('slot_5', sa.INTEGER(), autoincrement=False, nullable=True),
    sa.Column('slot_6', sa.INTEGER(), autoincrement=False, nullable=True),
    sa.Column('slot_7', sa.INTEGER(), autoincrement=False, nullable=True),
    sa.Column('slot_8', sa.INTEGER(), autoincrement=False, nullable=True),
    sa.Column('slot_9', sa.INTEGER(), autoincrement=False, nullable=True),
    sa.PrimaryKeyConstraint('id', name=op.f('nc_integrations_store_v2_pkey'))
    )
    op.create_index(op.f('nc_integrations_store_v2_fk_integration_id_index'), 'nc_integrations_store_v2', ['fk_integration_id'], unique=False)
    op.create_table('nc_user_comment_notifications_preference',
    sa.Column('id', sa.VARCHAR(length=20), autoincrement=False, nullable=False),
    sa.Column('row_id', sa.VARCHAR(length=255), autoincrement=False, nullable=True),
    sa.Column('user_id', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('fk_model_id', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('source_id', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('base_id', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('preferences', sa.VARCHAR(length=255), autoincrement=False, nullable=True),
    sa.Column('created_at', postgresql.TIMESTAMP(timezone=True), server_default=sa.text('CURRENT_TIMESTAMP'), autoincrement=False, nullable=False),
    sa.Column('updated_at', postgresql.TIMESTAMP(timezone=True), server_default=sa.text('CURRENT_TIMESTAMP'), autoincrement=False, nullable=False),
    sa.PrimaryKeyConstraint('id', name=op.f('nc_user_comment_notifications_preference_pkey'))
    )
    op.create_index(op.f('user_comments_preference_index'), 'nc_user_comment_notifications_preference', ['user_id', 'row_id', 'fk_model_id'], unique=False)
    op.create_index(op.f('nc_user_comment_notifications_preference_base_id_index'), 'nc_user_comment_notifications_preference', ['base_id'], unique=False)
    op.create_table('nc_sync_logs_v2',
    sa.Column('id', sa.VARCHAR(length=20), autoincrement=False, nullable=False),
    sa.Column('base_id', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('fk_sync_source_id', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('time_taken', sa.INTEGER(), autoincrement=False, nullable=True),
    sa.Column('status', sa.VARCHAR(length=255), autoincrement=False, nullable=True),
    sa.Column('status_details', sa.TEXT(), autoincrement=False, nullable=True),
    sa.Column('created_at', postgresql.TIMESTAMP(timezone=True), server_default=sa.text('CURRENT_TIMESTAMP'), autoincrement=False, nullable=False),
    sa.Column('updated_at', postgresql.TIMESTAMP(timezone=True), server_default=sa.text('CURRENT_TIMESTAMP'), autoincrement=False, nullable=False),
    sa.PrimaryKeyConstraint('id', name=op.f('nc_sync_logs_v2_pkey'))
    )
    op.create_index(op.f('nc_sync_logs_v2_base_id_index'), 'nc_sync_logs_v2', ['base_id'], unique=False)
    op.create_table('nc_hook_logs_v2',
    sa.Column('id', sa.VARCHAR(length=20), autoincrement=False, nullable=False),
    sa.Column('source_id', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('base_id', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('fk_hook_id', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('type', sa.VARCHAR(length=255), autoincrement=False, nullable=True),
    sa.Column('event', sa.VARCHAR(length=255), autoincrement=False, nullable=True),
    sa.Column('operation', sa.VARCHAR(length=255), autoincrement=False, nullable=True),
    sa.Column('test_call', sa.BOOLEAN(), server_default=sa.text('true'), autoincrement=False, nullable=True),
    sa.Column('payload', sa.TEXT(), autoincrement=False, nullable=True),
    sa.Column('conditions', sa.TEXT(), autoincrement=False, nullable=True),
    sa.Column('notification', sa.TEXT(), autoincrement=False, nullable=True),
    sa.Column('error_code', sa.VARCHAR(length=255), autoincrement=False, nullable=True),
    sa.Column('error_message', sa.VARCHAR(length=255), autoincrement=False, nullable=True),
    sa.Column('error', sa.TEXT(), autoincrement=False, nullable=True),
    sa.Column('execution_time', sa.INTEGER(), autoincrement=False, nullable=True),
    sa.Column('response', sa.TEXT(), autoincrement=False, nullable=True),
    sa.Column('triggered_by', sa.VARCHAR(length=255), autoincrement=False, nullable=True),
    sa.Column('created_at', postgresql.TIMESTAMP(timezone=True), server_default=sa.text('CURRENT_TIMESTAMP'), autoincrement=False, nullable=False),
    sa.Column('updated_at', postgresql.TIMESTAMP(timezone=True), server_default=sa.text('CURRENT_TIMESTAMP'), autoincrement=False, nullable=False),
    sa.PrimaryKeyConstraint('id', name=op.f('nc_hook_logs_v2_pkey'))
    )
    op.create_index(op.f('nc_hook_logs_v2_base_id_index'), 'nc_hook_logs_v2', ['base_id'], unique=False)
    op.create_table('nc_calendar_view_columns_v2',
    sa.Column('id', sa.VARCHAR(length=20), autoincrement=False, nullable=False),
    sa.Column('base_id', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('source_id', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('fk_view_id', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('fk_column_id', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('show', sa.BOOLEAN(), autoincrement=False, nullable=True),
    sa.Column('bold', sa.BOOLEAN(), autoincrement=False, nullable=True),
    sa.Column('underline', sa.BOOLEAN(), autoincrement=False, nullable=True),
    sa.Column('italic', sa.BOOLEAN(), autoincrement=False, nullable=True),
    sa.Column('order', sa.REAL(), autoincrement=False, nullable=True),
    sa.Column('created_at', postgresql.TIMESTAMP(timezone=True), server_default=sa.text('CURRENT_TIMESTAMP'), autoincrement=False, nullable=False),
    sa.Column('updated_at', postgresql.TIMESTAMP(timezone=True), server_default=sa.text('CURRENT_TIMESTAMP'), autoincrement=False, nullable=False),
    sa.PrimaryKeyConstraint('id', name=op.f('nc_calendar_view_columns_v2_pkey'))
    )
    op.create_index(op.f('nc_calendar_view_columns_v2_fk_view_id_fk_column_id_index'), 'nc_calendar_view_columns_v2', ['fk_view_id', 'fk_column_id'], unique=False)
    op.create_index(op.f('nc_calendar_view_columns_v2_base_id_index'), 'nc_calendar_view_columns_v2', ['base_id'], unique=False)
    op.create_table('nc_integrations_v2',
    sa.Column('id', sa.VARCHAR(length=20), autoincrement=False, nullable=False),
    sa.Column('title', sa.VARCHAR(length=128), autoincrement=False, nullable=True),
    sa.Column('config', sa.TEXT(), autoincrement=False, nullable=True),
    sa.Column('meta', sa.TEXT(), autoincrement=False, nullable=True),
    sa.Column('type', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('sub_type', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('is_private', sa.BOOLEAN(), server_default=sa.text('false'), autoincrement=False, nullable=True),
    sa.Column('deleted', sa.BOOLEAN(), server_default=sa.text('false'), autoincrement=False, nullable=True),
    sa.Column('created_by', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('order', sa.REAL(), autoincrement=False, nullable=True),
    sa.Column('created_at', postgresql.TIMESTAMP(timezone=True), server_default=sa.text('CURRENT_TIMESTAMP'), autoincrement=False, nullable=False),
    sa.Column('updated_at', postgresql.TIMESTAMP(timezone=True), server_default=sa.text('CURRENT_TIMESTAMP'), autoincrement=False, nullable=False),
    sa.Column('is_default', sa.BOOLEAN(), server_default=sa.text('false'), autoincrement=False, nullable=True),
    sa.Column('is_encrypted', sa.BOOLEAN(), server_default=sa.text('false'), autoincrement=False, nullable=True),
    sa.PrimaryKeyConstraint('id', name=op.f('nc_integrations_v2_pkey'))
    )
    op.create_index(op.f('nc_integrations_v2_type_index'), 'nc_integrations_v2', ['type'], unique=False)
    op.create_index(op.f('nc_integrations_v2_created_by_index'), 'nc_integrations_v2', ['created_by'], unique=False)
    op.create_table('nc_map_view_v2',
    sa.Column('fk_view_id', sa.VARCHAR(length=20), autoincrement=False, nullable=False),
    sa.Column('source_id', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('base_id', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('uuid', sa.VARCHAR(length=255), autoincrement=False, nullable=True),
    sa.Column('title', sa.VARCHAR(length=255), autoincrement=False, nullable=True),
    sa.Column('fk_geo_data_col_id', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('meta', sa.TEXT(), autoincrement=False, nullable=True),
    sa.Column('created_at', postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=True),
    sa.Column('updated_at', postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=True),
    sa.PrimaryKeyConstraint('fk_view_id', name=op.f('nc_map_view_v2_pkey'))
    )
    op.create_index(op.f('nc_map_view_v2_fk_view_id_index'), 'nc_map_view_v2', ['fk_view_id'], unique=False)
    op.create_index(op.f('nc_map_view_v2_fk_geo_data_col_id_index'), 'nc_map_view_v2', ['fk_geo_data_col_id'], unique=False)
    op.create_index(op.f('nc_map_view_v2_base_id_index'), 'nc_map_view_v2', ['base_id'], unique=False)
    op.create_table('xc_knex_migrationsv2',
    sa.Column('id', sa.INTEGER(), autoincrement=True, nullable=False),
    sa.Column('name', sa.VARCHAR(length=255), autoincrement=False, nullable=True),
    sa.Column('batch', sa.INTEGER(), autoincrement=False, nullable=True),
    sa.Column('migration_time', postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=True),
    sa.PrimaryKeyConstraint('id', name=op.f('xc_knex_migrationsv2_pkey'))
    )
    op.create_table('nc_audit_v2',
    sa.Column('id', sa.UUID(), autoincrement=False, nullable=False),
    sa.Column('user', sa.VARCHAR(length=255), autoincrement=False, nullable=True),
    sa.Column('ip', sa.VARCHAR(length=255), autoincrement=False, nullable=True),
    sa.Column('source_id', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('base_id', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('fk_model_id', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('row_id', sa.VARCHAR(length=255), autoincrement=False, nullable=True),
    sa.Column('op_type', sa.VARCHAR(length=255), autoincrement=False, nullable=True),
    sa.Column('op_sub_type', sa.VARCHAR(length=255), autoincrement=False, nullable=True),
    sa.Column('status', sa.VARCHAR(length=255), autoincrement=False, nullable=True),
    sa.Column('description', sa.TEXT(), autoincrement=False, nullable=True),
    sa.Column('details', sa.TEXT(), autoincrement=False, nullable=True),
    sa.Column('fk_user_id', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('fk_ref_id', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('fk_parent_id', sa.UUID(), autoincrement=False, nullable=True),
    sa.Column('fk_workspace_id', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('fk_org_id', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('user_agent', sa.TEXT(), autoincrement=False, nullable=True),
    sa.Column('version', sa.SMALLINT(), server_default=sa.text("'0'::smallint"), autoincrement=False, nullable=True),
    sa.Column('old_id', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('created_at', postgresql.TIMESTAMP(timezone=True), server_default=sa.text('CURRENT_TIMESTAMP'), autoincrement=False, nullable=False),
    sa.Column('updated_at', postgresql.TIMESTAMP(timezone=True), server_default=sa.text('CURRENT_TIMESTAMP'), autoincrement=False, nullable=False),
    sa.PrimaryKeyConstraint('id', name=op.f('nc_audit_v2_pkx'))
    )
    op.create_index(op.f('nc_record_audit_v2_tenant_idx'), 'nc_audit_v2', ['base_id', 'fk_model_id', 'row_id', 'fk_workspace_id'], unique=False)
    op.create_index(op.f('nc_audit_v2_tenant_idx'), 'nc_audit_v2', ['base_id', 'fk_workspace_id'], unique=False)
    op.create_index(op.f('nc_audit_v2_old_id_index'), 'nc_audit_v2', ['old_id'], unique=False)
    op.create_index(op.f('nc_audit_v2_fk_workspace_idx'), 'nc_audit_v2', ['fk_workspace_id'], unique=False)
    op.create_table('nc_store',
    sa.Column('id', sa.INTEGER(), autoincrement=True, nullable=False),
    sa.Column('base_id', sa.VARCHAR(length=255), autoincrement=False, nullable=True),
    sa.Column('db_alias', sa.VARCHAR(length=255), server_default=sa.text("'db'::character varying"), autoincrement=False, nullable=True),
    sa.Column('key', sa.VARCHAR(length=255), autoincrement=False, nullable=True),
    sa.Column('value', sa.TEXT(), autoincrement=False, nullable=True),
    sa.Column('type', sa.VARCHAR(length=255), autoincrement=False, nullable=True),
    sa.Column('env', sa.VARCHAR(length=255), autoincrement=False, nullable=True),
    sa.Column('tag', sa.VARCHAR(length=255), autoincrement=False, nullable=True),
    sa.Column('created_at', postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=True),
    sa.Column('updated_at', postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=True),
    sa.PrimaryKeyConstraint('id', name=op.f('nc_store_pkey'))
    )
    op.create_index(op.f('nc_store_key_index'), 'nc_store', ['key'], unique=False)
    op.create_table('nc_col_relations_v2',
    sa.Column('id', sa.VARCHAR(length=20), autoincrement=False, nullable=False),
    sa.Column('ref_db_alias', sa.VARCHAR(length=255), autoincrement=False, nullable=True),
    sa.Column('type', sa.VARCHAR(length=255), autoincrement=False, nullable=True),
    sa.Column('virtual', sa.BOOLEAN(), autoincrement=False, nullable=True),
    sa.Column('db_type', sa.VARCHAR(length=255), autoincrement=False, nullable=True),
    sa.Column('fk_column_id', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('fk_related_model_id', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('fk_child_column_id', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('fk_parent_column_id', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('fk_mm_model_id', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('fk_mm_child_column_id', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('fk_mm_parent_column_id', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('ur', sa.VARCHAR(length=255), autoincrement=False, nullable=True),
    sa.Column('dr', sa.VARCHAR(length=255), autoincrement=False, nullable=True),
    sa.Column('fk_index_name', sa.VARCHAR(length=255), autoincrement=False, nullable=True),
    sa.Column('deleted', sa.BOOLEAN(), autoincrement=False, nullable=True),
    sa.Column('created_at', postgresql.TIMESTAMP(timezone=True), server_default=sa.text('CURRENT_TIMESTAMP'), autoincrement=False, nullable=False),
    sa.Column('updated_at', postgresql.TIMESTAMP(timezone=True), server_default=sa.text('CURRENT_TIMESTAMP'), autoincrement=False, nullable=False),
    sa.Column('fk_target_view_id', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('base_id', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('fk_related_base_id', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('fk_mm_base_id', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('fk_related_source_id', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('fk_mm_source_id', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.PrimaryKeyConstraint('id', name=op.f('nc_col_relations_v2_pkey'))
    )
    op.create_index(op.f('nc_col_relations_v2_fk_target_view_id_index'), 'nc_col_relations_v2', ['fk_target_view_id'], unique=False)
    op.create_index(op.f('nc_col_relations_v2_fk_related_model_id_index'), 'nc_col_relations_v2', ['fk_related_model_id'], unique=False)
    op.create_index(op.f('nc_col_relations_v2_fk_parent_column_id_index'), 'nc_col_relations_v2', ['fk_parent_column_id'], unique=False)
    op.create_index(op.f('nc_col_relations_v2_fk_mm_parent_column_id_index'), 'nc_col_relations_v2', ['fk_mm_parent_column_id'], unique=False)
    op.create_index(op.f('nc_col_relations_v2_fk_mm_model_id_index'), 'nc_col_relations_v2', ['fk_mm_model_id'], unique=False)
    op.create_index(op.f('nc_col_relations_v2_fk_mm_child_column_id_index'), 'nc_col_relations_v2', ['fk_mm_child_column_id'], unique=False)
    op.create_index(op.f('nc_col_relations_v2_fk_column_id_index'), 'nc_col_relations_v2', ['fk_column_id'], unique=False)
    op.create_index(op.f('nc_col_relations_v2_fk_child_column_id_index'), 'nc_col_relations_v2', ['fk_child_column_id'], unique=False)
    op.create_index(op.f('nc_col_relations_v2_base_id_index'), 'nc_col_relations_v2', ['base_id'], unique=False)
    op.create_table('nc_col_select_options_v2',
    sa.Column('id', sa.VARCHAR(length=20), autoincrement=False, nullable=False),
    sa.Column('fk_column_id', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('title', sa.VARCHAR(length=255), autoincrement=False, nullable=True),
    sa.Column('color', sa.VARCHAR(length=255), autoincrement=False, nullable=True),
    sa.Column('order', sa.REAL(), autoincrement=False, nullable=True),
    sa.Column('created_at', postgresql.TIMESTAMP(timezone=True), server_default=sa.text('CURRENT_TIMESTAMP'), autoincrement=False, nullable=False),
    sa.Column('updated_at', postgresql.TIMESTAMP(timezone=True), server_default=sa.text('CURRENT_TIMESTAMP'), autoincrement=False, nullable=False),
    sa.Column('base_id', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.PrimaryKeyConstraint('id', name=op.f('nc_col_select_options_v2_pkey'))
    )
    op.create_index(op.f('nc_col_select_options_v2_fk_column_id_index'), 'nc_col_select_options_v2', ['fk_column_id'], unique=False)
    op.create_index(op.f('nc_col_select_options_v2_base_id_index'), 'nc_col_select_options_v2', ['base_id'], unique=False)
    op.create_table('nc_base_users_v2',
    sa.Column('base_id', sa.VARCHAR(length=20), autoincrement=False, nullable=False),
    sa.Column('fk_user_id', sa.VARCHAR(length=20), autoincrement=False, nullable=False),
    sa.Column('roles', sa.TEXT(), autoincrement=False, nullable=True),
    sa.Column('starred', sa.BOOLEAN(), autoincrement=False, nullable=True),
    sa.Column('pinned', sa.BOOLEAN(), autoincrement=False, nullable=True),
    sa.Column('group', sa.VARCHAR(length=255), autoincrement=False, nullable=True),
    sa.Column('color', sa.VARCHAR(length=255), autoincrement=False, nullable=True),
    sa.Column('order', sa.REAL(), autoincrement=False, nullable=True),
    sa.Column('hidden', sa.REAL(), autoincrement=False, nullable=True),
    sa.Column('opened_date', postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=True),
    sa.Column('created_at', postgresql.TIMESTAMP(timezone=True), server_default=sa.text('CURRENT_TIMESTAMP'), autoincrement=False, nullable=False),
    sa.Column('updated_at', postgresql.TIMESTAMP(timezone=True), server_default=sa.text('CURRENT_TIMESTAMP'), autoincrement=False, nullable=False),
    sa.Column('invited_by', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.PrimaryKeyConstraint('base_id', 'fk_user_id', name=op.f('nc_base_users_v2_pkey'))
    )
    op.create_index(op.f('nc_project_users_v2_fk_user_id_index'), 'nc_base_users_v2', ['fk_user_id'], unique=False)
    op.create_index(op.f('nc_base_users_v2_invited_by_index'), 'nc_base_users_v2', ['invited_by'], unique=False)
    op.create_index(op.f('nc_base_users_v2_base_id_index'), 'nc_base_users_v2', ['base_id'], unique=False)
    op.create_table('nc_shared_views_v2',
    sa.Column('id', sa.VARCHAR(length=20), autoincrement=False, nullable=False),
    sa.Column('fk_view_id', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('meta', sa.TEXT(), autoincrement=False, nullable=True),
    sa.Column('query_params', sa.TEXT(), autoincrement=False, nullable=True),
    sa.Column('view_id', sa.VARCHAR(length=255), autoincrement=False, nullable=True),
    sa.Column('show_all_fields', sa.BOOLEAN(), autoincrement=False, nullable=True),
    sa.Column('allow_copy', sa.BOOLEAN(), autoincrement=False, nullable=True),
    sa.Column('password', sa.VARCHAR(length=255), autoincrement=False, nullable=True),
    sa.Column('deleted', sa.BOOLEAN(), autoincrement=False, nullable=True),
    sa.Column('order', sa.REAL(), autoincrement=False, nullable=True),
    sa.Column('created_at', postgresql.TIMESTAMP(timezone=True), server_default=sa.text('CURRENT_TIMESTAMP'), autoincrement=False, nullable=False),
    sa.Column('updated_at', postgresql.TIMESTAMP(timezone=True), server_default=sa.text('CURRENT_TIMESTAMP'), autoincrement=False, nullable=False),
    sa.PrimaryKeyConstraint('id', name=op.f('nc_shared_views_v2_pkey'))
    )
    op.create_index(op.f('nc_shared_views_v2_fk_view_id_index'), 'nc_shared_views_v2', ['fk_view_id'], unique=False)
    op.create_table('nc_widgets_v2',
    sa.Column('id', sa.VARCHAR(length=20), autoincrement=False, nullable=False),
    sa.Column('fk_workspace_id', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('base_id', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('fk_dashboard_id', sa.VARCHAR(length=20), autoincrement=False, nullable=False),
    sa.Column('fk_model_id', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('fk_view_id', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('title', sa.VARCHAR(length=255), autoincrement=False, nullable=False),
    sa.Column('description', sa.TEXT(), autoincrement=False, nullable=True),
    sa.Column('type', sa.VARCHAR(length=50), autoincrement=False, nullable=False),
    sa.Column('config', sa.TEXT(), autoincrement=False, nullable=True),
    sa.Column('meta', sa.TEXT(), autoincrement=False, nullable=True),
    sa.Column('order', sa.INTEGER(), autoincrement=False, nullable=True),
    sa.Column('position', sa.TEXT(), autoincrement=False, nullable=True),
    sa.Column('created_at', postgresql.TIMESTAMP(timezone=True), server_default=sa.text('CURRENT_TIMESTAMP'), autoincrement=False, nullable=False),
    sa.Column('updated_at', postgresql.TIMESTAMP(timezone=True), server_default=sa.text('CURRENT_TIMESTAMP'), autoincrement=False, nullable=False),
    sa.Column('error', sa.BOOLEAN(), autoincrement=False, nullable=True),
    sa.PrimaryKeyConstraint('id', name=op.f('nc_widgets_v2_pkey'))
    )
    op.create_index(op.f('nc_widgets_dashboard_idx'), 'nc_widgets_v2', ['fk_dashboard_id'], unique=False)
    op.create_index(op.f('nc_widgets_context'), 'nc_widgets_v2', ['base_id', 'fk_workspace_id'], unique=False)
    op.create_table('nc_kanban_view_v2',
    sa.Column('fk_view_id', sa.VARCHAR(length=20), autoincrement=False, nullable=False),
    sa.Column('source_id', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('base_id', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('show', sa.BOOLEAN(), autoincrement=False, nullable=True),
    sa.Column('order', sa.REAL(), autoincrement=False, nullable=True),
    sa.Column('uuid', sa.VARCHAR(length=255), autoincrement=False, nullable=True),
    sa.Column('title', sa.VARCHAR(length=255), autoincrement=False, nullable=True),
    sa.Column('public', sa.BOOLEAN(), autoincrement=False, nullable=True),
    sa.Column('password', sa.VARCHAR(length=255), autoincrement=False, nullable=True),
    sa.Column('show_all_fields', sa.BOOLEAN(), autoincrement=False, nullable=True),
    sa.Column('created_at', postgresql.TIMESTAMP(timezone=True), server_default=sa.text('CURRENT_TIMESTAMP'), autoincrement=False, nullable=False),
    sa.Column('updated_at', postgresql.TIMESTAMP(timezone=True), server_default=sa.text('CURRENT_TIMESTAMP'), autoincrement=False, nullable=False),
    sa.Column('fk_grp_col_id', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('fk_cover_image_col_id', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('meta', sa.TEXT(), autoincrement=False, nullable=True),
    sa.PrimaryKeyConstraint('fk_view_id', name=op.f('nc_kanban_view_v2_pkey'))
    )
    op.create_index(op.f('nc_kanban_view_v2_fk_view_id_index'), 'nc_kanban_view_v2', ['fk_view_id'], unique=False)
    op.create_index(op.f('nc_kanban_view_v2_fk_grp_col_id_index'), 'nc_kanban_view_v2', ['fk_grp_col_id'], unique=False)
    op.create_index(op.f('nc_kanban_view_v2_base_id_index'), 'nc_kanban_view_v2', ['base_id'], unique=False)
    op.create_table('nc_hooks_v2',
    sa.Column('id', sa.VARCHAR(length=20), autoincrement=False, nullable=False),
    sa.Column('source_id', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('base_id', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('fk_model_id', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('title', sa.VARCHAR(length=255), autoincrement=False, nullable=True),
    sa.Column('description', sa.VARCHAR(length=255), autoincrement=False, nullable=True),
    sa.Column('env', sa.VARCHAR(length=255), server_default=sa.text("'all'::character varying"), autoincrement=False, nullable=True),
    sa.Column('type', sa.VARCHAR(length=255), autoincrement=False, nullable=True),
    sa.Column('event', sa.VARCHAR(length=255), autoincrement=False, nullable=True),
    sa.Column('operation', sa.VARCHAR(length=255), autoincrement=False, nullable=True),
    sa.Column('async', sa.BOOLEAN(), server_default=sa.text('false'), autoincrement=False, nullable=True),
    sa.Column('payload', sa.BOOLEAN(), server_default=sa.text('true'), autoincrement=False, nullable=True),
    sa.Column('url', sa.TEXT(), autoincrement=False, nullable=True),
    sa.Column('headers', sa.TEXT(), autoincrement=False, nullable=True),
    sa.Column('condition', sa.BOOLEAN(), server_default=sa.text('false'), autoincrement=False, nullable=True),
    sa.Column('notification', sa.TEXT(), autoincrement=False, nullable=True),
    sa.Column('retries', sa.INTEGER(), server_default=sa.text('0'), autoincrement=False, nullable=True),
    sa.Column('retry_interval', sa.INTEGER(), server_default=sa.text('60000'), autoincrement=False, nullable=True),
    sa.Column('timeout', sa.INTEGER(), server_default=sa.text('60000'), autoincrement=False, nullable=True),
    sa.Column('active', sa.BOOLEAN(), server_default=sa.text('true'), autoincrement=False, nullable=True),
    sa.Column('created_at', postgresql.TIMESTAMP(timezone=True), server_default=sa.text('CURRENT_TIMESTAMP'), autoincrement=False, nullable=False),
    sa.Column('updated_at', postgresql.TIMESTAMP(timezone=True), server_default=sa.text('CURRENT_TIMESTAMP'), autoincrement=False, nullable=False),
    sa.Column('version', sa.VARCHAR(length=255), autoincrement=False, nullable=True),
    sa.Column('trigger_field', sa.BOOLEAN(), server_default=sa.text('false'), autoincrement=False, nullable=True),
    sa.PrimaryKeyConstraint('id', name=op.f('nc_hooks_v2_pkey'))
    )
    op.create_index(op.f('nc_hooks_v2_fk_model_id_index'), 'nc_hooks_v2', ['fk_model_id'], unique=False)
    op.create_index(op.f('nc_hooks_v2_base_id_index'), 'nc_hooks_v2', ['base_id'], unique=False)
    op.create_table('nc_sort_v2',
    sa.Column('id', sa.VARCHAR(length=20), autoincrement=False, nullable=False),
    sa.Column('source_id', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('base_id', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('fk_view_id', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('fk_column_id', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('direction', sa.VARCHAR(length=255), server_default=sa.text("'false'::character varying"), autoincrement=False, nullable=True),
    sa.Column('order', sa.REAL(), autoincrement=False, nullable=True),
    sa.Column('created_at', postgresql.TIMESTAMP(timezone=True), server_default=sa.text('CURRENT_TIMESTAMP'), autoincrement=False, nullable=False),
    sa.Column('updated_at', postgresql.TIMESTAMP(timezone=True), server_default=sa.text('CURRENT_TIMESTAMP'), autoincrement=False, nullable=False),
    sa.PrimaryKeyConstraint('id', name=op.f('nc_sort_v2_pkey'))
    )
    op.create_index(op.f('nc_sort_v2_fk_view_id_index'), 'nc_sort_v2', ['fk_view_id'], unique=False)
    op.create_index(op.f('nc_sort_v2_fk_column_id_index'), 'nc_sort_v2', ['fk_column_id'], unique=False)
    op.create_index(op.f('nc_sort_v2_base_id_index'), 'nc_sort_v2', ['base_id'], unique=False)
    # ### end Alembic commands ###
